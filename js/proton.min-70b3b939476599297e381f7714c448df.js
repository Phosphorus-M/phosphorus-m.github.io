!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Proton=e()}(this,function(){"use strict";function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function t(t,e){t.prototype=Object.create(e.prototype),u(t.prototype.constructor=t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1}function f(t,e){return[1,0,0,0,1,0,t,e,1]}function g(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],h=t[6],l=t[7],t=t[8],c=e[0],u=e[1],d=e[2],p=e[3],f=e[4],g=e[5],y=e[6],m=e[7],e=e[8];return[i*c+n*p+r*y,i*u+n*f+r*m,i*d+n*g+r*e,s*c+a*p+o*y,s*u+a*f+o*m,s*d+a*g+o*e,h*c+l*p+t*y,h*u+l*f+t*m,h*d+l*g+t*e]}function y(t,e,i){var n="string"==typeof t?t:t.src;v[n]?e(v[n],i):((t=new Image).onload=function(t){v[n]=t.target,e(v[n],i)},t.src=n)}var m={createCanvas:function(t,e,i,n){void 0===n&&(n="absolute");var r=document.createElement("canvas");return r.id=t,r.width=e,r.height=i,r.style.opacity=0,r.style.position=n,this.transform(r,-500,-500,0,0),r},createDiv:function(t,e,i){var n=document.createElement("div");return n.id=t,n.style.position="absolute",this.resize(n,e,i),n},resize:function(t,e,i){t.style.width=e+"px",t.style.height=i+"px",t.style.marginLeft=-e/2+"px",t.style.marginTop=-i/2+"px"},transform:function(t,e,i,n,r){t.style.willChange="transform",this.css3(t,"transform","translate("+e+"px, "+i+"px) scale("+n+") rotate("+r+"deg)")},transform3d:function(t,e,i,n,r){t.style.willChange="transform";e="translate3d("+e+"px, "+i+"px, 0) scale("+n+") rotate("+r+"deg)";this.css3(t,"backfaceVisibility","hidden"),this.css3(t,"transform",e)},css3:function(t,e,i){var n=e.charAt(0).toUpperCase()+e.substr(1);t.style["Webkit"+n]=i,t.style["Moz"+n]=i,t.style["O"+n]=i,t.style["ms"+n]=i,t.style[""+e]=i}},v={},b={},x=0,a={initValue:function(t,e){return null!=t?t:e},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyArray:function(t){t&&(t.length=0)},toArray:function(t){return this.isArray(t)?t:[t]},getRandFromArray:function(t){return t?t[Math.floor(t.length*Math.random())]:null},emptyObject:function(t,e){for(var i in void 0===e&&(e=null),t)e&&-1<e.indexOf(i)||delete t[i]},classApply:function(t,e){return new((e=void 0===e?null:e)?t.bind.apply(t,[null].concat(e)):t)},getImageData:function(t,e,i){return t.drawImage(e,i.x,i.y),e=t.getImageData(i.x,i.y,i.width,i.height),t.clearRect(i.x,i.y,i.width,i.height),e},destroyAll:function(t,e){void 0===e&&(e=null);for(var i=t.length;i--;){try{t[i].destroy(e)}catch(t){}delete t[i]}t.length=0},assign:function(t,e){if("function"==typeof Object.assign)return Object.assign(t,e);for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}},E={},A={_index:0,_cache:{},id:function(t){return void 0!==E[t]&&null!==E[t]||(E[t]=0),t+"_"+E[t]++},getId:function(t){var e;return this.getIdFromCache(t)||(e="PUID_"+this._index++,this._cache[e]=t,e)},getIdFromCache:function(t){var e,i;for(i in this._cache){if((e=this._cache[i])===t)return i;if(this.isBody(e,t)&&e.src===t.src)return i}return null},isBody:function(t,e){return"object"==typeof t&&"object"==typeof e&&t.isInner&&e.isInner},getTarget:function(t){return this._cache[t]}},P=((e=D.prototype).get=function(t,e,i){return i=i||t.__puid||A.getId(t),(e=this.cache[i]&&0<this.cache[i].length?this.cache[i].pop():this.createOrClone(t,e)).__puid=t.__puid||i,e},e.expire=function(t){return this.getCache(t.__puid).push(t)},e.createOrClone=function(t,e){return this.total++,this.create?this.create(t,e):"function"==typeof t?a.classApply(t,e):t.clone()},e.getCount=function(){var t,e=0;for(t in this.cache)e+=this.cache[t].length;return e++},e.destroy=function(){for(var t in this.cache)this.cache[t].length=0,delete this.cache[t]},e.getCache=function(t){return this.cache[t=void 0===t?"default":t]||(this.cache[t]=[]),this.cache[t]},D),T=((e=S.prototype).update=function(t,e){this.add(t,e);var i=this.getEmitter(),n=this.getRenderer(),r="";switch(this.type){case 2:r+="emitter:"+this.proton.emitters.length+"<br>",i&&(r+="em speed:"+i.emitSpeed+"<br>"),i&&(r+="pos:"+this.getEmitterPos(i));break;case 3:i&&(r+="initializes:"+i.initializes.length+"<br>"),i&&(r+='<span style="display:inline-block;">'+this.concatArr(i.initializes)+"</span><br>"),i&&(r+="behaviours:"+i.behaviours.length+"<br>"),i&&(r+='<span style="display:inline-block;">'+this.concatArr(i.behaviours)+"</span><br>");break;case 4:n&&(r+=n.name+"<br>"),n&&(r+="body:"+this.getCreatedNumber(n)+"<br>");break;default:r=(r=(r+="particles:"+this.proton.getCount()+"<br>")+("pool:"+this.proton.pool.getCount()+"<br>"))+("total:"+this.proton.pool.total)}this.container.innerHTML=r},e.add=function(t,e){var i,n,r=this;if(!this.container){switch(this.type=1,this.container=document.createElement("div"),this.container.style.cssText=["position:absolute;bottom:0px;left:0;cursor:pointer;","opacity:0.9;z-index:10000;padding:10px;font-size:12px;font-family:Helvetica,Arial,sans-serif;","width:120px;height:50px;background-color:#002;color:#0ff;"].join(""),this.container.addEventListener("click",function(t){r.type++,4<r.type&&(r.type=1)},!1),t){case 2:i="#201",n="#f08";break;case 3:i="#020",n="#0f0";break;default:i="#002",n="#0ff"}this.container.style["background-color"]=i,this.container.style.color=n}this.container.parentNode||(e=e||this.body||document.body).appendChild(this.container)},e.getEmitter=function(){return this.proton.emitters[this.emitterIndex]},e.getRenderer=function(){return this.proton.renderers[this.rendererIndex]},e.concatArr=function(t){var e="";if(!t||!t.length)return e;for(var i=0;i<t.length;i++)e+=(t[i].name||"").substr(0,1)+".";return e},e.getCreatedNumber=function(t){return t.pool.total||t.cpool&&t.cpool.total||0},e.getEmitterPos=function(t){return Math.round(t.p.x)+","+Math.round(t.p.y)},e.destroy=function(){this.container&&this.container.parentNode&&(this.body||document.body).removeChild(this.container),this.proton=null,this.container=null},S),e=(I.bind=function(t){t.prototype.dispatchEvent=I.prototype.dispatchEvent,t.prototype.hasEventListener=I.prototype.hasEventListener,t.prototype.addEventListener=I.prototype.addEventListener,t.prototype.removeEventListener=I.prototype.removeEventListener,t.prototype.removeAllEventListeners=I.prototype.removeAllEventListeners},(e=I.prototype).addEventListener=function(t,e){return this._listeners?this.removeEventListener(t,e):this._listeners={},this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),e},e.removeEventListener=function(t,e){if(this._listeners&&this._listeners[t])for(var i=this._listeners[t],n=i.length,r=0;r<n;r++)if(i[r]===e){1===n?delete this._listeners[t]:i.splice(r,1);break}},e.removeAllEventListeners=function(t){t?this._listeners&&delete this._listeners[t]:this._listeners=null},e.dispatchEvent=function(t,e){var i=!1,n=this._listeners;if(t&&n){var r,s=n[t];if(!s)return i;for(var a=s.length;a--;)r=s[a],i=i||r(e)}return!!i},e.hasEventListener=function(t){var e=this._listeners;return!(!e||!e[t])},I),R=3.1415926,o={PI:R,PIx2:2*R,PI_2:R/2,PI_180:R/180,N180_PI:180/R,Infinity:-999,isInfinity:function(t){return t===this.Infinity||1/0===t},randomAToB:function(t,e,i){return(i=void 0===i?!1:i)?(Math.random()*(e-t)>>0)+t:t+Math.random()*(e-t)},randomFloating:function(t,e,i){return this.randomAToB(t-e,t+e,i)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},randomZone:function(t){},floor:function(t,e){void 0===e&&(e=4);e=Math.pow(10,e);return Math.floor(t*e)/e},degreeTransform:function(t){return t*R/180},toColor16:function(t){return"#"+t.toString(16)}},_=((n=C.prototype).calculate=function(t,e,i){this.eulerIntegrate(t,e,i)},n.eulerIntegrate=function(t,e,i){t.sleep||(t.old.p.copy(t.p),t.old.v.copy(t.v),t.a.multiplyScalar(1/t.mass),t.v.add(t.a.multiplyScalar(e)),t.p.add(t.old.v.multiplyScalar(e)),i&&t.v.multiplyScalar(i),t.a.clear())},C),i=((n=w.prototype).addRenderer=function(t){t.init(this),this.renderers.push(t)},n.removeRenderer=function(t){var e=this.renderers.indexOf(t);this.renderers.splice(e,1),t.remove(this)},n.addEmitter=function(t){this.emitters.push(t),(t.parent=this).dispatchEvent(w.EMITTER_ADDED,t)},n.removeEmitter=function(t){var e=this.emitters.indexOf(t);this.emitters.splice(e,1),t.parent=null,this.dispatchEvent(w.EMITTER_REMOVED,t)},n.update=function(){"auto"===this._fps?(this.dispatchEvent(w.PROTON_UPDATE),w.USE_CLOCK?(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.amendChangeTabsBug(),0<this.elapsed&&this.emittersUpdate(this.elapsed),this.then=this.now):this.emittersUpdate(w.DEFAULT_INTERVAL),this.dispatchEvent(w.PROTON_UPDATE_AFTER)):(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.elapsed>this._interval&&(this.dispatchEvent(w.PROTON_UPDATE),this.emittersUpdate(this._interval),this.then=this.now-this.elapsed%this._interval*1e3,this.dispatchEvent(w.PROTON_UPDATE_AFTER)))},n.emittersUpdate=function(t){for(var e=this.emitters.length;e--;)this.emitters[e].update(t)},n.amendChangeTabsBug=function(){w.amendChangeTabsBug&&.5<this.elapsed&&(this.then=(new Date).getTime(),this.elapsed=0)},n.getCount=function(){for(var t=0,e=this.emitters.length;e--;)t+=this.emitters[e].particles.length;return t},n.getAllParticles=function(){for(var t=[],e=this.emitters.length;e--;)t=t.concat(this.emitters[e].particles);return t},n.destroyAllEmitters=function(){a.destroyAll(this.emitters)},n.destroy=function(t){function e(){i.time=0,i.then=0,i.pool.destroy(),i.stats.destroy(),a.destroyAll(i.emitters),a.destroyAll(i.renderers,i.getAllParticles()),i.integrator=null,i.renderers=null,i.emitters=null,i.stats=null,i.pool=null}var i=this;(t=void 0===t?!1:t)?setTimeout(e,200):e()},c(w.prototype,[{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t,this._interval="auto"===t?w.DEFAULT_INTERVAL:o.floor(1/t,7)}}]),w);function w(t){this.emitters=[],this.renderers=[],this.time=0,this.now=0,this.then=0,this.elapsed=0,this.stats=new T(this),this.pool=new P(80),this.integrationType=a.initValue(t,w.EULER),this.integrator=new _(this.integrationType),this._fps="auto",this._interval=w.DEFAULT_INTERVAL}function C(t){this.type=t}function I(){this._listeners=null}function S(t){this.proton=t,this.container=null,this.type=1,this.emitterIndex=0,this.rendererIndex=0}function D(t){this.total=0,this.cache={}}i.USE_CLOCK=!1,i.MEASURE=100,i.EULER="euler",i.RK2="runge-kutta2",i.PARTICLE_CREATED="PARTICLE_CREATED",i.PARTICLE_UPDATE="PARTICLE_UPDATE",i.PARTICLE_SLEEP="PARTICLE_SLEEP",i.PARTICLE_DEAD="PARTICLE_DEAD",i.EMITTER_ADDED="EMITTER_ADDED",i.EMITTER_REMOVED="EMITTER_REMOVED",i.PROTON_UPDATE="PROTON_UPDATE",i.PROTON_UPDATE_AFTER="PROTON_UPDATE_AFTER",i.DEFAULT_INTERVAL=.0167,i.amendChangeTabsBug=!0,e.bind(i);Pt.prototype.reset=function(){this.r=255,this.g=255,this.b=255};var V,M,B,L,U,F,z,O,k=Pt,N={hasProp:function(t,e){return!!t&&void 0!==t[e]},setProp:function(t,e){for(var i in e)t.hasOwnProperty(i)&&(t[i]=Span.getSpanValue(e[i]));return t},setVectorVal:function(t,e){(e=void 0===e?null:e)&&(this.hasProp(e,"x")&&(t.p.x=e.x),this.hasProp(e,"y")&&(t.p.y=e.y),this.hasProp(e,"vx")&&(t.v.x=e.vx),this.hasProp(e,"vy")&&(t.v.y=e.vy),this.hasProp(e,"ax")&&(t.a.x=e.ax),this.hasProp(e,"ay")&&(t.a.y=e.ay),this.hasProp(e,"p")&&t.p.copy(e.p),this.hasProp(e,"v")&&t.v.copy(e.v),this.hasProp(e,"a")&&t.a.copy(e.a),this.hasProp(e,"position")&&t.p.copy(e.position),this.hasProp(e,"velocity")&&t.v.copy(e.velocity),this.hasProp(e,"accelerate")&&t.a.copy(e.accelerate))}},H={easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return 1-Math.cos(t*o.PI_2)},easeOutSine:function(t){return Math.sin(t*o.PI_2)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return--t*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},getEasing:function(t){return"function"==typeof t?t:this[t]||this.easeLinear}},s=((n=At.prototype).set=function(t,e){return this.x=t,this.y=e,this},n.setX=function(t){return this.x=t,this},n.setY=function(t){return this.y=t,this},n.getGradient=function(){return 0!==this.x?Math.atan2(this.y,this.x):0<this.y?o.PI_2:this.y<0?-o.PI_2:void 0},n.copy=function(t){return this.x=t.x,this.y=t.y,this},n.add=function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},n.addXY=function(t,e){return this.x+=t,this.y+=e,this},n.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},n.sub=function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},n.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},n.divideScalar=function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},n.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},n.negate=function(){return this.multiplyScalar(-1)},n.dot=function(t){return this.x*t.x+this.y*t.y},n.lengthSq=function(){return this.x*this.x+this.y*this.y},n.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.normalize=function(){return this.divideScalar(this.length())},n.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},n.rotate=function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)+i*Math.sin(t),this.y=-e*Math.sin(t)+i*Math.cos(t),this},n.distanceToSquared=function(t){var e=this.x-t.x,t=this.y-t.y;return e*e+t*t},n.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},n.equals=function(t){return t.x===this.x&&t.y===this.y},n.clear=function(){return this.x=0,this.y=0,this},n.clone=function(){return new At(this.x,this.y)},At),q=((n=Et.prototype).getDirection=function(){return Math.atan2(this.v.x,-this.v.y)*o.N180_PI},n.reset=function(){return this.life=1/0,this.age=0,this.dead=!1,this.sleep=!1,this.body=null,this.sprite=null,this.parent=null,this.energy=1,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.easing=H.easeLinear,this.rgb.reset(),a.emptyObject(this.data),this.removeAllBehaviours(),this},n.update=function(t,e){this.sleep||(this.age+=t,this.applyBehaviours(t,e)),this.age<this.life?(t=this.easing(this.age/this.life),this.energy=Math.max(1-t,0)):this.destroy()},n.applyBehaviours=function(t,e){for(var i=this.behaviours.length,n=0;n<i;n++)this.behaviours[n]&&this.behaviours[n].applyBehaviour(this,t,e)},n.addBehaviour=function(t){this.behaviours.push(t),t.hasOwnProperty("parents")&&t.parents.push(this),t.initialize(this)},n.addBehaviours=function(t){for(var e=t.length,i=0;i<e;i++)this.addBehaviour(t[i])},n.removeBehaviour=function(t){t=this.behaviours.indexOf(t);-1<t&&(this.behaviours.splice(t,1).parents=null)},n.removeAllBehaviours=function(){a.emptyArray(this.behaviours)},n.destroy=function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null},Et),G={hexToRgb:function(t){t="#"===t.charAt(0)?t.substring(1,7):t;return{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}},rgbToHex:function(t){return"rgb("+t.r+", "+t.g+", "+t.b+")"},getHex16FromParticle:function(t){return 65536*Number(t.rgb.r)+256*Number(t.rgb.g)+Number(t.rgb.b)}},X=((n=xt.prototype).set=function(t,e){return this.r=t,this.tha=e,this},n.setR=function(t){return this.r=t,this},n.setTha=function(t){return this.tha=t,this},n.copy=function(t){return this.r=t.r,this.tha=t.tha,this},n.toVector=function(){return new s(this.getX(),this.getY())},n.getX=function(){return this.r*Math.sin(this.tha)},n.getY=function(){return-this.r*Math.cos(this.tha)},n.normalize=function(){return this.r=1,this},n.equals=function(t){return t.r===this.r&&t.tha===this.tha},n.clear=function(){return this.r=0,this.tha=0,this},n.clone=function(){return new xt(this.r,this.tha)},xt),Y={create:function(t){var e=new Float32Array(9);return t&&this.set(t,e),e},set:function(t,e){for(var i=0;i<9;i++)e[i]=t[i];return e},multiply:function(t,e,i){var n=t[0],r=t[1],c=t[2],s=t[3],a=t[4],u=t[6],t=t[7],o=e[0],h=e[1],d=e[2],l=e[3],p=e[4],f=e[6],e=e[7];return i[0]=o*n+h*s,i[1]=o*r+h*a,i[2]=c*d,i[3]=l*n+p*s,i[4]=l*r+p*a,i[6]=f*n+e*s+u,i[7]=f*r+e*a+t,i},inverse:function(t,e){var i=t[0],n=t[1],r=t[3],s=t[4],a=t[6],t=t[7],o=-r,r=t*r-s*a,h=1/(i*s+n*o);return e[0]=s*h,e[1]=-n*h,e[3]=o*h,e[4]=i*h,e[6]=r*h,e[7]=(-t*i+n*a)*h,e},multiplyVec2:function(t,e,i){var n=e[0],e=e[1];return i[0]=n*t[0]+e*t[3]+t[6],i[1]=n*t[1]+e*t[4]+t[7],i}},j=(bt.prototype.getValue=function(t){return void 0===t&&(t=!1),this.isArray?a.getRandFromArray(this.a):this.center?o.randomFloating(this.a,this.b,t):o.randomAToB(this.a,this.b,t)},bt.setSpanValue=function(t,e,i){return t instanceof bt?t:void 0===e?new bt(t):void 0===i?new bt(t,e):new bt(t,e,i)},bt.getSpanValue=function(t){return t instanceof bt?t.getValue():t},bt),W=(t(vt,O=j),vt.prototype.getValue=function(){var t=a.getRandFromArray(this._arr);return"random"===t||"Random"===t?o.randomColor():t},vt.createArraySpan=function(t){return t?t instanceof vt?t:new vt(t):null},vt),Z=(mt.prototype.contains=function(t,e){return t<=this.right&&t>=this.x&&e<=this.bottom&&e>=this.y},mt),Q=((n=yt.prototype).init=function(){this.startTime=0,this.nextTime=this.timePan.getValue()},n.getValue=function(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),1===this.numPan.b?.5<this.numPan.getValue(!1)?1:0:this.numPan.getValue(!0)):0},yt),K=((n=gt.prototype).reset=function(){},n.init=function(t,e){e?this.initialize(e):this.initialize(t)},n.initialize=function(t){},gt),n=(t(ft,z=K),ft.prototype.initialize=function(t){this.lifePan.a===1/0?t.life=1/0:t.life=this.lifePan.getValue()},ft),J=((J=pt.prototype).getPosition=function(){},J.crossing=function(t){},J.destroy=function(){this.vector=null},pt),$=(t(dt,F=J),(tt=dt.prototype).getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector},tt.crossing=function(t){this.alert&&(console.error("Sorry, PointZone does not support crossing method!"),this.alert=!1)},dt),tt=(t(ut,U=K),(tt=ut.prototype).reset=function(t){this.zone=a.initValue(t,new $)},tt.initialize=function(t){this.zone.getPosition(),t.p.x=this.zone.vector.x,t.p.y=this.zone.vector.y},ut),et=(t(ct,L=K),(et=ct.prototype).reset=function(t,e,i){this.rPan=j.setSpanValue(t),this.thaPan=j.setSpanValue(e),this.type=a.initValue(i,"vector")},et.normalizeVelocity=function(t){return t*i.MEASURE},et.initialize=function(t){var e;"p"===this.type||"P"===this.type||"polar"===this.type?(e=new X(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*o.PI_180),t.v.x=e.getX(),t.v.y=e.getY()):(t.v.x=this.normalizeVelocity(this.rPan.getValue()),t.v.y=this.normalizeVelocity(this.thaPan.getValue()))},ct),it=(t(lt,B=K),lt.prototype.initialize=function(t){t.mass=this.massPan.getValue()},lt),nt=(t(ht,M=K),(nt=ht.prototype).reset=function(t,e,i){this.radius=j.setSpanValue(t,e,i)},nt.initialize=function(t){t.radius=this.radius.getValue(),t.data.oldRadius=t.radius},ht),rt=(t(ot,V=K),(rt=ot.prototype).initialize=function(t){var e=this.image.getValue();t.body="string"==typeof e?{width:this.w,height:this.h,src:e,isInner:!0,inner:!0}:e},rt.setSpanValue=function(t){return t instanceof W?t:new W(t)},ot),st=((st=at.prototype).reset=function(t,e){this.life=a.initValue(t,1/0),this.easing=H.getEasing(e)},st.normalizeForce=function(t){return t.multiplyScalar(i.MEASURE)},st.normalizeValue=function(t){return t*i.MEASURE},st.initialize=function(t){},st.calculate=function(t,e,i){this.age+=e,this.age>=this.life||this.dead?(this.energy=0,this.dead=!0,this.destroy()):(e=this.easing(t.age/t.life),this.energy=Math.max(1-e,0))},st.destroy=function(){for(var t=this.parents.length;t--;)this.parents[t].removeBehaviour(this);this.parents.length=0},at);function at(t,e){this.life=a.initValue(t,1/0),this.easing=H.getEasing(e),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.id="Behaviour_"+at.id++,this.name="Behaviour"}function ot(t,e,i){var n;return(n=V.call(this)||this).image=n.setSpanValue(t),n.w=a.initValue(e,20),n.h=a.initValue(i,n.w),n.name="Body",n}function ht(t,e,i){var n;return(n=M.call(this)||this).radius=j.setSpanValue(t,e,i),n.name="Radius",n}function lt(t,e,i){var n;return(n=B.call(this)||this).massPan=j.setSpanValue(t,e,i),n.name="Mass",n}function ct(t,e,i){var n;return(n=L.call(this)||this).rPan=j.setSpanValue(t),n.thaPan=j.setSpanValue(e),n.type=a.initValue(i,"vector"),n.name="Velocity",n}function ut(t){var e;return(e=U.call(this)||this).zone=a.initValue(t,new $),e.name="Position",e}function dt(t,e){var i;return(i=F.call(this)||this).x=t,i.y=e,i}function pt(){this.vector=new s(0,0),this.random=0,this.crossType="dead",this.alert=!0}function ft(t,e,i){var n;return(n=z.call(this)||this).lifePan=j.setSpanValue(t,e,i),n.name="Life",n}function gt(){}function yt(t,e){this.numPan=j.setSpanValue(a.initValue(t,1)),this.timePan=j.setSpanValue(a.initValue(e,1)),this.startTime=0,this.nextTime=0,this.init()}function mt(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n,this.bottom=this.y+this.height,this.right=this.x+this.width}function vt(t){var e;return(e=O.call(this)||this)._arr=a.toArray(t),e}function bt(t,e,i){a.isArray(t)?(this.isArray=!0,this.a=t):(this.isArray=!1,this.a=a.initValue(t,1),this.b=a.initValue(e,this.a),this.center=a.initValue(i,!1))}function xt(t,e){this.r=Math.abs(t)||0,this.tha=e||0}function Et(t){this.id="",this.old={},this.data={},this.behaviours=[],this.p=[],this.v=[],this.a=[],this.rgb={},this.name="Particle",this.id=A.id(this.name),this.old={},this.data={},this.behaviours=[],this.p=new s,this.v=new s,this.a=new s,this.old.p=new s,this.old.v=new s,this.old.a=new s,this.rgb=new k,this.reset(),t&&N.setProp(this,t)}function At(t,e){this.x=t||0,this.y=e||0}function Pt(t,e,i){void 0===e&&(e=255),void 0===i&&(i=255),this.r=t=void 0===t?255:t,this.g=e,this.b=i}st.id=0;t(de,Ft=st),(zt=de.prototype).reset=function(t,e,i,n){this.force=this.normalizeForce(new s(t,e)),i&&Ft.prototype.reset.call(this,i,n)},zt.applyBehaviour=function(t,e,i){this.calculate(t,e,i),t.a.add(this.force)};var Tt,Rt,_t,wt,Ct,It,St,Dt,Vt,Mt,Bt,Lt,Ut,Ft,zt=de,Ot=(t(ue,Ut=st),(Ot=ue.prototype).reset=function(t,e,i,n,r){this.targetPosition=a.initValue(t,new s),this.radius=a.initValue(i,1e3),this.force=a.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new s,this.lengthSq=0,n&&Ut.prototype.reset.call(this,n,r)},Ot.applyBehaviour=function(t,e,i){this.calculate(t,e,i),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.p),this.lengthSq=this.attractionForce.lengthSq(),4e-5<this.lengthSq&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),t.a.add(this.attractionForce))},ue),kt=(t(ce,Lt=st),(kt=ce.prototype).reset=function(t,e,i,n,r){this.panFoce=new s(t,e),this.panFoce=this.normalizeForce(this.panFoce),this.delay=i,n&&Lt.prototype.reset.call(this,n,r)},kt.initialize=function(t){t.data.time=0},kt.applyBehaviour=function(t,e,i){this.calculate(t,e,i),t.data.time+=e,t.data.time>=this.delay&&(t.a.addXY(o.randomAToB(-this.panFoce.x,this.panFoce.x),o.randomAToB(-this.panFoce.y,this.panFoce.y)),t.data.time=0)},ce),Nt=(t(le,Bt=zt),le.prototype.reset=function(t,e,i){Bt.prototype.reset.call(this,0,t,e,i)},le),Ht=(t(he,Mt=st),(Ht=he.prototype).reset=function(t,e,i,n,r){this.emitter=a.initValue(t,null),this.mass=a.initValue(e,!0),this.callback=a.initValue(i,null),this.collisionPool=[],this.delta=new s,n&&Mt.prototype.reset.call(this,n,r)},Ht.applyBehaviour=function(t,l,e){for(var i,n,r,s,a=(this.emitter?this.emitter.particles:this.pool).slice(e),o=a.length,h=0;h<o;h++)(i=a[h])!==t&&(this.delta.copy(i.p),this.delta.sub(t.p),(r=this.delta.lengthSq())<=(s=t.radius+i.radius)*s&&(s=s-Math.sqrt(r),s+=.5,r=t.mass+i.mass,n=this.mass?i.mass/r:.5,r=this.mass?t.mass/r:.5,t.p.add(this.delta.clone().normalize().multiplyScalar(s*-n)),i.p.add(this.delta.normalize().multiplyScalar(s*r)),this.callback&&this.callback(t,i)))},he),qt=(t(oe,Vt=st),(qt=oe.prototype).reset=function(t,e,i,n){this.zone=t,this.zone.crossType=a.initValue(e,"dead"),i&&Vt.prototype.reset.call(this,i,n)},qt.applyBehaviour=function(t,e,i){this.calculate(t,e,i),this.zone.crossing(t)},oe),Gt=(t(ae,Dt=st),(Gt=ae.prototype).reset=function(t,e,i,n){this.same=null==e,this.a=j.setSpanValue(a.initValue(t,1)),this.b=j.setSpanValue(e),i&&Dt.prototype.reset.call(this,i,n)},Gt.initialize=function(t){t.data.alphaA=this.a.getValue(),this.same?t.data.alphaB=t.data.alphaA:t.data.alphaB=this.b.getValue()},Gt.applyBehaviour=function(t,e,i){this.calculate(t,e,i),t.alpha=t.data.alphaB+(t.data.alphaA-t.data.alphaB)*this.energy,t.alpha<.001&&(t.alpha=0)},ae),Xt=(t(se,St=st),(Xt=se.prototype).reset=function(t,e,i,n){this.same=null==e,this.a=j.setSpanValue(a.initValue(t,1)),this.b=j.setSpanValue(e),i&&St.prototype.reset.call(this,i,n)},Xt.initialize=function(t){t.data.scaleA=this.a.getValue(),t.data.oldRadius=t.radius,t.data.scaleB=this.same?t.data.scaleA:this.b.getValue()},Xt.applyBehaviour=function(t,e,i){this.calculate(t,e,i),t.scale=t.data.scaleB+(t.data.scaleA-t.data.scaleB)*this.energy,t.scale<1e-4&&(t.scale=0),t.radius=t.data.oldRadius*t.scale},se),Yt=(t(re,It=st),(Yt=re.prototype).reset=function(t,e,i,n,r){this.same=null==e,this.a=j.setSpanValue(a.initValue(t,"Velocity")),this.b=j.setSpanValue(a.initValue(e,0)),this.style=a.initValue(i,"to"),n&&It.prototype.reset.call(this,n,r)},Yt.initialize=function(t){t.rotation=this.a.getValue(),t.data.rotationA=this.a.getValue(),this.same||(t.data.rotationB=this.b.getValue())},Yt.applyBehaviour=function(t,e,i){this.calculate(t,e,i),this.same?"V"!==this.a.a&&"Velocity"!==this.a.a&&"v"!==this.a.a||(t.rotation=t.getDirection()):"to"===this.style||"TO"===this.style||"_"===this.style?t.rotation+=t.data.rotationB+(t.data.rotationA-t.data.rotationB)*this.energy:t.rotation+=t.data.rotationB},re),jt=(t(ne,Ct=st),(jt=ne.prototype).reset=function(t,e,i,n){this.a=W.createArraySpan(t),this.b=W.createArraySpan(e),i&&Ct.prototype.reset.call(this,i,n)},jt.initialize=function(t){t.color=this.a.getValue(),t.data.colorA=G.hexToRgb(t.color),this.b&&(t.data.colorB=G.hexToRgb(this.b.getValue()))},jt.applyBehaviour=function(t,e,i){this.b?(this.calculate(t,e,i),t.rgb.r=t.data.colorB.r+(t.data.colorA.r-t.data.colorB.r)*this.energy,t.rgb.g=t.data.colorB.g+(t.data.colorA.g-t.data.colorB.g)*this.energy,t.rgb.b=t.data.colorB.b+(t.data.colorA.b-t.data.colorB.b)*this.energy,t.rgb.r=t.rgb.r<<0,t.rgb.g=t.rgb.g<<0,t.rgb.b=t.rgb.b<<0):(t.rgb.r=t.data.colorA.r,t.rgb.g=t.data.colorA.g,t.rgb.b=t.data.colorA.b)},ne),Wt="changing",Zt=(t(ie,wt=st),(Zt=ie.prototype).setAngleAndForce=function(t,e){this.force=Wt,this.angle=o.PI/2,"right"===t?this.angle=o.PI/2:"left"===t?this.angle=-o.PI/2:"random"===t?this.angle="random":t instanceof j?(this.angle="span",this.span=t):t&&(this.angle=t),"changing"===String(e).toLowerCase()||"chang"===String(e).toLowerCase()||"auto"===String(e).toLowerCase()?this.force=Wt:e&&(this.force=e)},Zt.reset=function(t,e,i,n){this.angle=o.PI/2,this.setAngleAndForce(t,e),i&&wt.prototype.reset.call(this,i,n)},Zt.initialize=function(t){"random"===this.angle?t.data.cangle=o.randomAToB(-o.PI,o.PI):"span"===this.angle&&(t.data.cangle=this.span.getValue()),t.data.cyclone=new s(0,0)},Zt.applyBehaviour=function(t,e,i){this.calculate(t,e,i);e=t.v.getGradient();"random"===this.angle||"span"===this.angle?e+=t.data.cangle:e+=this.angle,i=this.force===Wt?t.v.length()/100:this.force,t.data.cyclone.x=i*Math.cos(e),t.data.cyclone.y=i*Math.sin(e),t.data.cyclone=this.normalizeForce(t.data.cyclone),t.a.add(t.data.cyclone)},ie),Qt=(t(ee,_t=Ot),ee.prototype.reset=function(t,e,i,n,r){_t.prototype.reset.call(this,t,e,i,n,r),this.force*=-1},ee),Kt=(t(te,Rt=st),(Kt=te.prototype).reset=function(t,e,i,n){this.distanceVec=new s,this.centerPoint=a.initValue(t,new s),this.force=a.initValue(this.normalizeValue(e),100),i&&Rt.prototype.reset.call(this,i,n)},Kt.initialize=function(t){},Kt.applyBehaviour=function(t,e,i){this.distanceVec.set(this.centerPoint.x-t.p.x,this.centerPoint.y-t.p.y);var n,r=this.distanceVec.lengthSq();0!==r&&(n=this.distanceVec.length(),e=this.force*e/(r*n),t.v.x+=e*this.distanceVec.x,t.v.y+=e*this.distanceVec.y)},te),Jt={initialize:function(t,e,i){for(var n=i.length,r=0;r<n;r++)i[r]instanceof K?i[r].init(t,e):this.init(t,e,i[r]);this.bindEmitter(t,e)},init:function(t,e,i){N.setProp(e,i),N.setVectorVal(e,i)},bindEmitter:function(t,e){t.bindEmitter&&(e.p.add(t.p),e.v.add(t.v),e.a.add(t.a),e.v.rotate(o.degreeTransform(t.rotation)))}},r=(t($t,Tt=q),(r=$t.prototype).emit=function(t,e){this.stoped=!1,this.emitTime=0,this.totalTime=a.initValue(t,1/0),!0===e||"life"===e||"destroy"===e?this.life="once"===t?1:this.totalTime:isNaN(e)||(this.life=e),this.rate.init()},r.stop=function(){this.totalTime=-1,this.emitTime=0,this.stoped=!0},r.preEmit=function(t){var e=this.stoped,i=this.emitTime,n=this.totalTime;this.stoped=!1,this.emitTime=0,this.totalTime=t,this.rate.init();for(;.0167<t;)t-=.0167,this.update(.0167);this.stoped=e,this.emitTime=i+Math.max(t,0),this.totalTime=n},r.removeAllParticles=function(){for(var t=this.particles.length;t--;)this.particles[t].dead=!0},r.addSelfInitialize=function(t){t.init?t.init(this):this.initAll()},r.addInitialize=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=e.length;n--;)this.initializes.push(e[n])},r.removeInitialize=function(t){t=this.initializes.indexOf(t);-1<t&&this.initializes.splice(t,1)},r.removeAllInitializers=function(){a.emptyArray(this.initializes)},r.addBehaviour=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=arguments.length;n--;){var r=e[n];this.behaviours.push(r),r.parents&&r.parents.push(this)}},r.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);return this.behaviours.splice(e,1),t.parents&&(e=t.parents.indexOf(t),t.parents.splice(e,1)),e},r.removeAllBehaviours=function(){a.emptyArray(this.behaviours)},r.update=function(t){this.age+=t,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(t),this.integrate(t)},r.integrate=function(t){if(this.parent){var e,i,n=1-this.damping;for(this.parent.integrator.calculate(this,t,n),e=this.particles.length-1;0<=e;e--)(i=this.particles[e]).update(t,e),this.parent.integrator.calculate(i,t,n),this.dispatch("PARTICLE_UPDATE",i),i.dead&&(this.dispatch("PARTICLE_DEAD",i),this.parent.pool.expire(i),this.particles.splice(e,1))}},r.dispatch=function(t,e){this.parent&&this.parent.dispatchEvent(t,e),this.bindEvent&&this.dispatchEvent(t,e)},r.emitting=function(t){if("once"===this.totalTime){var e,i=this.rate.getValue(99999);for(0<i&&(this.emitSpeed=i),e=0;e<i;e++)this.createParticle();this.totalTime="none"}else if(this.emitTime+=t,this.emitTime<this.totalTime){var n,r=this.rate.getValue(t);for(0<r&&(this.emitSpeed=r),n=0;n<r;n++)this.createParticle()}},r.createParticle=function(t,e){var i=this.parent.pool.get(q);return this.setupParticle(i,t,e),this.dispatch("PARTICLE_CREATED",i),i},r.setupParticle=function(t,e,i){var n=this.initializes,r=this.behaviours;e&&(n=a.toArray(e)),i&&(r=a.toArray(i)),t.reset(),Jt.initialize(this,t,n),t.addBehaviours(r),(t.parent=this).particles.push(t)},r.remove=function(){this.stop(),a.destroyAll(this.particles)},r.destroy=function(){this.dead=!0,this.remove(),this.removeAllInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this),this.rate=null,this.old=null,this.rgb=null,this.v=null,this.a=null,this.p=null},$t);function $t(t){return(t=Tt.call(this,t=void 0===t?{}:t)||this).particles=[],t.behaviours=[],t.initializes=[],t.emitTime=0,t.emitSpeed=0,t.totalTime=-1,t.damping=.006,t.bindEmitter=!0,t.rate=new Q(1,.1),t.name="Emitter",t.id=A.id(t.name),t}function te(t,e,i,n){return(i=Rt.call(this,i,n)||this).distanceVec=new s,i.centerPoint=a.initValue(t,new s),i.force=a.initValue(i.normalizeValue(e),100),i.name="GravityWell",i}function ee(t,e,i,n,r){return(t=_t.call(this,t,e,i,n,r)||this).force*=-1,t.name="Repulsion",t}function ie(t,e,i,n){return(i=wt.call(this,i,n)||this).setAngleAndForce(t,e),i.name="Cyclone",i}function ne(t,e,i,n){return(i=Ct.call(this,i,n)||this).reset(t,e),i.name="Color",i}function re(t,e,i,n,r){return(n=It.call(this,n,r)||this).reset(t,e,i),n.name="Rotate",n}function se(t,e,i,n){return(i=St.call(this,i,n)||this).reset(t,e),i.name="Scale",i}function ae(t,e,i,n){return(i=Dt.call(this,i,n)||this).reset(t,e),i.name="Alpha",i}function oe(t,e,i,n){return(i=Vt.call(this,i,n)||this).reset(t,e),i.name="CrossZone",i}function he(t,e,i,n,r){return(n=Mt.call(this,n,r)||this).reset(t,e,i),n.name="Collision",n}function le(t,e,i){return(t=Bt.call(this,0,t,e,i)||this).name="Gravity",t}function ce(t,e,i,n,r){return(n=Lt.call(this,n,r)||this).reset(t,e,i),n.time=0,n.name="RandomDrift",n}function ue(t,e,i,n,r){return(n=Ut.call(this,n,r)||this).targetPosition=a.initValue(t,new s),n.radius=a.initValue(i,1e3),n.force=a.initValue(n.normalizeValue(e),100),n.radiusSq=n.radius*n.radius,n.attractionForce=new s,n.lengthSq=0,n.name="Attraction",n}function de(t,e,i,n){return(i=Ft.call(this,i,n)||this).force=i.normalizeForce(new s(t,e)),i.name="Force",i}e.bind(r);function pe(t){if(t){if(t.__isImage)return 1;var e=(""+t.tagName).toUpperCase();return("IMG"===(""+t.nodeName).toUpperCase()||"IMG"===e)&&(t.__isImage=!0)}}function fe(t){return"string"==typeof t}t(ei,Ce=r),(e=ei.prototype).addSelfBehaviour=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=e.length,r=0;r<n;r++){var s=e[r];this.selfBehaviours.push(s),s.initialize(this)}},e.removeSelfBehaviour=function(t){t=this.selfBehaviours.indexOf(t);-1<t&&this.selfBehaviours.splice(t,1)},e.update=function(t){if(Ce.prototype.update.call(this,t),!this.sleep)for(var e=this.selfBehaviours.length,i=0;i<e;i++)this.selfBehaviours[i].applyBehaviour(this,t,i)};var ge,ye,me,ve,be,xe,Ee,Ae,Pe,Te,Re,_e,we,Ce,e=ei,Ie=(t(ti,we=r),(Ie=ti.prototype).initEventHandler=function(){var e=this;this.mousemoveHandler=function(t){return e.mousemove.call(e,t)},this.mousedownHandler=function(t){return e.mousedown.call(e,t)},this.mouseupHandler=function(t){return e.mouseup.call(e,t)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},Ie.emit=function(){this._allowEmitting=!0},Ie.stop=function(){this._allowEmitting=!1},Ie.mousemove=function(t){t.layerX||0===t.layerX?(this.p.x+=(t.layerX-this.p.x)*this.ease,this.p.y+=(t.layerY-this.p.y)*this.ease):!t.offsetX&&0!==t.offsetX||(this.p.x+=(t.offsetX-this.p.x)*this.ease,this.p.y+=(t.offsetY-this.p.y)*this.ease),this._allowEmitting&&we.prototype.emit.call(this,"once")},Ie.destroy=function(){we.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},ti),Se=((Se=$e.prototype).setStroke=function(t,e){this.stroke={color:t=void 0===t?"#000000":t,thinkness:e=void 0===e?1:e}},Se.initEventHandler=function(){var e=this;this._protonUpdateHandler=function(){e.onProtonUpdate.call(e)},this._protonUpdateAfterHandler=function(){e.onProtonUpdateAfter.call(e)},this._emitterAddedHandler=function(t){e.onEmitterAdded.call(e,t)},this._emitterRemovedHandler=function(t){e.onEmitterRemoved.call(e,t)},this._particleCreatedHandler=function(t){e.onParticleCreated.call(e,t)},this._particleUpdateHandler=function(t){e.onParticleUpdate.call(e,t)},this._particleDeadHandler=function(t){e.onParticleDead.call(e,t)}},Se.init=function(t){(this.parent=t).addEventListener("PROTON_UPDATE",this._protonUpdateHandler),t.addEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),t.addEventListener("EMITTER_ADDED",this._emitterAddedHandler),t.addEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),t.addEventListener("PARTICLE_CREATED",this._particleCreatedHandler),t.addEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),t.addEventListener("PARTICLE_DEAD",this._particleDeadHandler)},Se.resize=function(t,e){},Se.destroy=function(){this.remove(),this.pool.destroy(),this.pool=null,this.element=null,this.stroke=null},Se.remove=function(t){this.parent.removeEventListener("PROTON_UPDATE",this._protonUpdateHandler),this.parent.removeEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),this.parent.removeEventListener("EMITTER_ADDED",this._emitterAddedHandler),this.parent.removeEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),this.parent.removeEventListener("PARTICLE_CREATED",this._particleCreatedHandler),this.parent.removeEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),this.parent.removeEventListener("PARTICLE_DEAD",this._particleDeadHandler),this.parent=null},Se.onProtonUpdate=function(){},Se.onProtonUpdateAfter=function(){},Se.onEmitterAdded=function(t){},Se.onEmitterRemoved=function(t){},Se.onParticleCreated=function(t){},Se.onParticleUpdate=function(t){},Se.onParticleDead=function(t){},$e),De=(t(Je,_e=Se),(De=Je.prototype).resize=function(t,e){this.element.width=t,this.element.height=e},De.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},De.onParticleCreated=function(t){t.body?y(t.body,this.addImg2Body,t):t.color=t.color||"#ff0000"},De.onParticleUpdate=function(t){t.body?pe(t.body)&&this.drawImage(t):this.drawCircle(t)},De.onParticleDead=function(t){t.body=null},De.addImg2Body=function(t,e){e.body=t},De.drawImage=function(t){var e,i=t.body.width*t.scale|0,n=t.body.height*t.scale|0,r=t.p.x-i/2,s=t.p.y-n/2;t.color?(t.data.buffer||(t.data.buffer=this.createBuffer(t.body)),(e=t.data.buffer.getContext("2d")).clearRect(0,0,t.data.buffer.width,t.data.buffer.height),e.globalAlpha=t.alpha,e.drawImage(t.body,0,0),e.globalCompositeOperation="source-atop",e.fillStyle=G.rgbToHex(t.rgb),e.fillRect(0,0,t.data.buffer.width,t.data.buffer.height),e.globalCompositeOperation="source-over",e.globalAlpha=1,this.context.drawImage(t.data.buffer,0,0,t.data.buffer.width,t.data.buffer.height,r,s,i,n)):(this.context.save(),this.context.globalAlpha=t.alpha,this.context.translate(t.p.x,t.p.y),this.context.rotate(o.degreeTransform(t.rotation)),this.context.translate(-t.p.x,-t.p.y),this.context.drawImage(t.body,0,0,t.body.width,t.body.height,r,s,i,n),this.context.globalAlpha=1,this.context.restore())},De.drawCircle=function(t){t.rgb?this.context.fillStyle="rgba("+t.rgb.r+","+t.rgb.g+","+t.rgb.b+","+t.alpha+")":this.context.fillStyle=t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},De.createBuffer=function(t){var e,i;if(pe(t))return e=t.width+"_"+t.height,(i=this.bufferCache[e])||((i=document.createElement("canvas")).width=t.width,i.height=t.height,this.bufferCache[e]=i),i},De.destroy=function(){_e.prototype.destroy.call(this),this.stroke=null,this.context=null,this.bufferCache=null},Je),Ve=(t(Ke,Re=Se),(Ve=Ke.prototype).onParticleCreated=function(t){t.body?y(t.body,this.addImg2Body,t):(t.body=this.pool.get(this.circleConf,t),this.element.appendChild(t.body))},Ve.onParticleUpdate=function(t){this.bodyReady(t)&&(this.transform3d?m.transform3d(t.body,t.p.x,t.p.y,t.scale,t.rotation):m.transform(t.body,t.p.x,t.p.y,t.scale,t.rotation),t.body.style.opacity=t.alpha,t.body.isCircle&&(t.body.style.backgroundColor=t.color||"#ff0000"))},Ve.onParticleDead=function(t){this.bodyReady(t)&&(this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null)},Ve.bodyReady=function(t){return"object"==typeof t.body&&t.body&&!t.body.isInner},Ve.addImg2Body=function(t,e){e.dead||(e.body=this.pool.get(t,e),m.resize(e.body,t.width,t.height),this.element.appendChild(e.body))},Ve.createBody=function(t,e){return t.isCircle?this.createCircle(e):this.createSprite(t,e)},Ve.createCircle=function(t){var e=m.createDiv(t.id+"_dom",2*t.radius,2*t.radius);return e.style.borderRadius=t.radius+"px",this.stroke&&(e.style.borderColor=this.stroke.color,e.style.borderWidth=this.stroke.thinkness+"px"),e.isCircle=!0,e},Ve.createSprite=function(t,e){var i="string"==typeof t?t:t.src,e=m.createDiv(e.id+"_dom",t.width,t.height);return e.style.backgroundImage="url("+i+")",e},Ve.destroy=function(){Re.prototype.destroy.call(this),this.stroke=null},Ke),Me=(t(Qe,Te=Se),(Me=Qe.prototype).onParticleCreated=function(t){t.body?this.createSprite(t):this.createCircle(t),this.element.addChild(t.body)},Me.onParticleUpdate=function(t){t.body&&(t.body.x=t.p.x,t.body.y=t.p.y,t.body.alpha=t.alpha,t.body.scaleX=t.body.scaleY=t.scale,t.body.rotation=t.rotation)},Me.onParticleDead=function(t){t.body&&(t.body.parent&&t.body.parent.removeChild(t.body),this.pool.expire(t.body),t.body=null),t.graphics&&this.pool.expire(t.graphics)},Me.createSprite=function(t){t.body=this.pool.get(t.body),t.body.parent||t.body.image&&(t.body.regX=t.body.image.width/2,t.body.regY=t.body.image.height/2)},Me.createCircle=function(t){var e=this.pool.get(createjs.Graphics),i=(this.stroke&&(fe(this.stroke)?e.beginStroke(this.stroke):e.beginStroke("#000000")),e.beginFill(t.color||"#ff0000").drawCircle(0,0,t.radius),this.pool.get(createjs.Shape,[e]));t.body=i,t.graphics=e},Me.destroy=function(){Te.prototype.destroy.call(this),this.stroke=null},Qe),Be=(t(Ze,Pe=Se),(Be=Ze.prototype).resize=function(t,e){this.element.width=t,this.element.height=e},Be.createImageData=function(t){this.rectangle=t||new Z(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},Be.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)},Be.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},Be.onParticleCreated=function(t){},Be.onParticleUpdate=function(t){this.imageData&&this.setPixel(this.imageData,t.p.x-this.rectangle.x>>0,t.p.y-this.rectangle.y>>0,t)},Be.setPixel=function(t,e,i,n){var r=n.rgb;e<0||e>this.element.width||i<0||i>this.elementwidth||(i=4*((i>>0)*t.width+(e>>0)),t.data[i]=r.r,t.data[1+i]=r.g,t.data[2+i]=r.b,t.data[3+i]=255*n.alpha)},Be.onParticleDead=function(t){},Be.destroy=function(){Pe.prototype.destroy.call(this),this.stroke=null,this.context=null,this.imageData=null,this.rectangle=null},Ze),Le=(t(We,Ae=Se),(Le=We.prototype).setPIXI=function(t){try{ge=t||{Sprite:{}},this.createFromImage=ge.Sprite.from||ge.Sprite.fromImage}catch(t){}},Le.onProtonUpdate=function(){},Le.onParticleCreated=function(t){t.body?t.body=this.pool.get(t.body,t):t.body=this.pool.get(this.circleConf,t),this.blendMode&&(t.body.blendMode=this.blendMode),this.element.addChild(t.body)},Le.onParticleUpdate=function(t){this.transform(t,t.body),!0!==this.setColor&&!0!==this.color||(t.body.tint=G.getHex16FromParticle(t))},Le.onParticleDead=function(t){this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null},Le.transform=function(t,e){e.x=t.p.x,e.y=t.p.y,e.alpha=t.alpha,e.scale.x=t.scale,e.scale.y=t.scale,e.rotation=t.rotation*o.PI_180},Le.createBody=function(t,e){return t.isCircle?this.createCircle(e):this.createSprite(t)},Le.createSprite=function(t){t=t.isInner?this.createFromImage(t.src):new ge.Sprite(t);return t.anchor.x=.5,t.anchor.y=.5,t},Le.createCircle=function(t){var e,i=new ge.Graphics;return this.stroke&&(e=fe(this.stroke)?this.stroke:0,i.beginStroke(e)),i.beginFill(t.color||36077),i.drawCircle(0,0,t.radius),i.endFill(),i},Le.destroy=function(t){Ae.prototype.destroy.call(this);for(var e=t.length;e--;){var i=t[e];i.body&&this.element.removeChild(i.body)}},We),Ue=((h=je.prototype).set=function(t,e){0===e?Y.set(t,this.mats[0]):Y.multiply(this.mats[e-1],t,this.mats[e]),this.size=Math.max(this.size,e+1)},h.push=function(t){0===this.size?Y.set(t,this.mats[0]):Y.multiply(this.mats[this.size-1],t,this.mats[this.size]),this.size++},h.pop=function(){0<this.size&&this.size--},h.top=function(){return this.mats[this.size-1]},je),h=(t(Ye,Ee=Se),(h=Ye.prototype).init=function(t){Ee.prototype.init.call(this,t),this.resize(this.element.width,this.element.height)},h.resize=function(t,e){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/t,this.smat[4]=1/e,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,t,e),this.element.width=t,this.element.height=e},h.setMaxRadius=function(t){this.circleCanvasURL=this.createCircle(t)},h.getVertexShader=function(){return["uniform vec2 viewport;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 tMat;","varying vec2 vTextureCoord;","varying float alpha;","void main() {","vec3 v = tMat * vec3(aVertexPosition, 1.0);","gl_Position = vec4(v.x, v.y, 0, 1);","vTextureCoord = aTextureCoord;","alpha = tMat[0][2];","}"].join("\n")},h.getFragmentShader=function(){return["precision mediump float;","varying vec2 vTextureCoord;","varying float alpha;","uniform sampler2D uSampler;","uniform vec4 color;","uniform bool useTexture;","uniform vec3 uColor;","void main() {","vec4 textureColor = texture2D(uSampler, vTextureCoord);","gl_FragColor = textureColor * vec4(uColor, 1.0);","gl_FragColor.w *= alpha;","}"].join("\n")},h.initVar=function(){this.mstack=new Ue,this.umat=Y.create([2,0,1,0,-2,0,-1,1,1]),this.smat=Y.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}},h.blendEquation=function(t){this.gl.blendEquation(this.gl[t])},h.blendFunc=function(t,e){this.gl.blendFunc(this.gl[t],this.gl[e])},h.getShader=function(t,e,i){i=i?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert(t.getShaderInfoLog(i)),null)},h.initShaders=function(){var t=this.getShader(this.gl,this.getFragmentShader(),!0),e=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,e),this.gl.attachShader(this.sprogram,t),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)},h.initBuffers=function(){this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,3,1,0,2,3]),this.gl.STATIC_DRAW);for(var t,e=[],i=0;i<100;i++)e.push(i);for(t=new Uint16Array(e),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW),e=[],i=0;i<100;i++)e.push(i,i+1,i+2);t=new Uint16Array(e),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW)},h.createCircle=function(t){this.circleCanvasRadius=p(a.initValue(t,32));var t=m.createCanvas("circle_canvas",2*this.circleCanvasRadius,2*this.circleCanvasRadius),e=t.getContext("2d");return e.beginPath(),e.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,2*Math.PI,!0),e.closePath(),e.fillStyle="#FFF",e.fill(),t.toDataURL()},h.drawImg2Canvas=function(t){var e=t.body.width,i=t.body.height,n=p(t.body.width),r=p(t.body.height),s=t.body.width/n,a=t.body.height/r,s=(this.texturebuffers[t.data.src]||(this.texturebuffers[t.data.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),t.data.texture=this.texturebuffers[t.data.src][0],t.data.vcBuffer=this.texturebuffers[t.data.src][1],t.data.tcBuffer=this.texturebuffers[t.data.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,s,0,0,a,a,a]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,e,0,0,i,e,i]),this.gl.STATIC_DRAW),t.data.canvas.getContext("2d").getImageData(0,0,n,r));this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),t.data.textureLoaded=!0,t.data.textureWidth=e,t.data.textureHeight=i},h.onProtonUpdate=function(){},h.onParticleCreated=function(t){t.data.textureLoaded=!1,t.data.tmat=Y.create(),t.data.tmat[8]=1,t.data.imat=Y.create(),t.data.imat[8]=1,t.body?y(t.body,this.addImg2Body,t):(y(this.circleCanvasURL,this.addImg2Body,t),t.data.oldScale=t.radius/this.circleCanvasRadius)},h.addImg2Body=function(t,e){var i,n,r,s,a;e.dead||(e.body=t,e.data.src=t.src,e.data.canvas=(a=(t=t).src,b[a]||(s=p(t.width),r=p(t.height),(s=m.createCanvas("proton_canvas_cache_"+ ++x,s,r)).getContext("2d").drawImage(t,0,0,t.width,t.height),b[a]=s),i&&i(b[a],n),b[a]),e.data.oldScale=1,this.drawImg2Canvas(e))},h.onParticleUpdate=function(t){t.data.textureLoaded&&(this.updateMatrix(t),this.gl.uniform3f(this.sprogram.color,t.rgb.r/255,t.rgb.g/255,t.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())},h.onParticleDead=function(t){},h.updateMatrix=function(t){var e=f(-t.data.textureWidth/2,-t.data.textureHeight/2),i=f(t.p.x,t.p.y),n=t.rotation*o.PI_180,n=(n=n,r=Math.cos(n),n=Math.sin(n),[r,-n,0,n,r,0,0,0,1]),r=t.scale*t.data.oldScale,e=g(e,[r,0,0,0,r,0,0,0,1]),e=g(e,n);e=g(e,i),Y.inverse(e,t.data.imat),e[2]=t.alpha,this.mstack.push(e)},h.destroy=function(){Ee.prototype.destroy.call(this),this.gl=null,this.mstack=null,this.umat=null,this.smat=null,this.texturebuffers=null},Ye),Se=(t(Xe,xe=Se),Xe),Fe=(t(Ge,be=J),(l=Ge.prototype).getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector},l.getDirection=function(t,e){var i=this.dy,n=-this.dx;return 0<(i*t+n*e+this.dot)*(0==n?1:n)},l.getDistance=function(t,e){return(this.dy*t+-this.dx*e+this.dot)/Math.sqrt(this.xxyy)},l.getSymmetric=function(t){var e=t.getGradient(),e=2*(this.getGradient()-e),i=t.x,n=t.y;return t.x=i*Math.cos(e)-n*Math.sin(e),t.y=i*Math.sin(e)+n*Math.cos(e),t},l.getGradient=function(){return Math.atan2(this.dy,this.dx)},l.rangeOut=function(t){if(Math.abs(this.getGradient())<=o.PI/4){if(t.p.x<=this.maxx&&t.p.x>=this.minx)return!0}else if(t.p.y<=this.maxy&&t.p.y>=this.miny)return!0;return!1},l.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},l.crossing=function(t){"dead"===this.crossType?">"===this.direction||"R"===this.direction||"right"===this.direction||"down"===this.direction?this.rangeOut(t)&&this.getDirection(t.p.x,t.p.y)&&(t.dead=!0):this.rangeOut(t)&&(this.getDirection(t.p.x,t.p.y)||(t.dead=!0)):"bound"===this.crossType?this.rangeOut(t)&&this.getDistance(t.p.x,t.p.y)<=t.radius&&(0===this.dx?t.v.x*=-1:0===this.dy?t.v.y*=-1:this.getSymmetric(t.v)):"cross"===this.crossType&&this.alert&&(console.error("Sorry, LineZone does not support cross method!"),this.alert=!1)},Ge),ze=(t(qe,ve=J),(l=qe.prototype).getPosition=function(){return this.angle=o.PIx2*Math.random(),this.randomRadius=Math.random()*this.radius,this.vector.x=this.x+this.randomRadius*Math.cos(this.angle),this.vector.y=this.y+this.randomRadius*Math.sin(this.angle),this.vector},l.setCenter=function(t,e){this.center.x=t,this.center.y=e},l.crossing=function(t){var e=t.p.distanceTo(this.center);"dead"===this.crossType?e-t.radius>this.radius&&(t.dead=!0):"bound"===this.crossType?e+t.radius>=this.radius&&this.getSymmetric(t):"cross"===this.crossType&&this.alert&&(console.error("Sorry, CircleZone does not support cross method!"),this.alert=!1)},l.getSymmetric=function(t){var e=t.v.getGradient(),e=2*(this.getGradient(t)-e),i=t.v.x,n=t.v.y;t.v.x=i*Math.cos(e)-n*Math.sin(e),t.v.y=i*Math.sin(e)+n*Math.cos(e)},l.getGradient=function(t){return-o.PI_2+Math.atan2(t.p.y-this.center.y,t.p.x-this.center.x)},qe),Oe=(t(He,me=J),(l=He.prototype).getPosition=function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector},l.crossing=function(t){"dead"===this.crossType?((t.p.x+t.radius<this.x||t.p.x-t.radius>this.x+this.width)&&(t.dead=!0),(t.p.y+t.radius<this.y||t.p.y-t.radius>this.y+this.height)&&(t.dead=!0)):"bound"===this.crossType?(t.p.x-t.radius<this.x?(t.p.x=this.x+t.radius,t.v.x*=-1):t.p.x+t.radius>this.x+this.width&&(t.p.x=this.x+this.width-t.radius,t.v.x*=-1),t.p.y-t.radius<this.y?(t.p.y=this.y+t.radius,t.v.y*=-1):t.p.y+t.radius>this.y+this.height&&(t.p.y=this.y+this.height-t.radius,t.v.y*=-1)):"cross"===this.crossType&&(t.p.x+t.radius<this.x&&t.v.x<=0?t.p.x=this.x+this.width+t.radius:t.p.x-t.radius>this.x+this.width&&0<=t.v.x&&(t.p.x=this.x-t.radius),t.p.y+t.radius<this.y&&t.v.y<=0?t.p.y=this.y+this.height+t.radius:t.p.y-t.radius>this.y+this.height&&0<=t.v.y&&(t.p.y=this.y-t.radius))},He),l=(t(Ne,ye=J),(l=Ne.prototype).reset=function(t,e,i,n){this.imageData=t,this.x=a.initValue(e,0),this.y=a.initValue(i,0),this.d=a.initValue(n,2),this.vectors=[],this.setVectors()},l.setVectors=function(){for(var t,e=this.imageData.width,i=this.imageData.height,n=0;n<e;n+=this.d)for(t=0;t<i;t+=this.d)0<this.imageData.data[3+4*((t>>0)*e+(n>>0))]&&this.vectors.push({x:n+this.x,y:t+this.y});return this.vector},l.getBound=function(t,e){e=4*((e>>0)*this.imageData.width+(t>>0));return 0<this.imageData.data[3+e]},l.getPosition=function(){var t=a.getRandFromArray(this.vectors);return this.vector.copy(t)},l.getColor=function(t,e){t-=this.x;e=4*(((e-=this.y)>>0)*this.imageData.width+(t>>0));return{r:this.imageData.data[e],g:this.imageData.data[1+e],b:this.imageData.data[2+e],a:this.imageData.data[3+e]}},l.crossing=function(t){"dead"===this.crossType?this.getBound(t.p.x-this.x,t.p.y-this.y)?t.dead=!0:t.dead=!1:"bound"===this.crossType&&(this.getBound(t.p.x-this.x,t.p.y-this.y)||t.v.negate())},l.destroy=function(){ye.prototype.destroy.call(this),this.imageData=null},Ne),ke={addEventListener:function(t,e){t.addEventListener("PROTON_UPDATE_AFTER",function(){return e()})},getStyle:function(t){t=G.hexToRgb(t=void 0===t?"#ff0000":t);return"rgba("+t.r+", "+t.g+", "+t.b+", 0.5)"},drawZone:function(t,e,i,n){var r=e.getContext("2d"),s=this.getStyle();this.addEventListener(t,function(){n&&r.clearRect(0,0,e.width,e.height),i instanceof $?(r.beginPath(),r.fillStyle=s,r.arc(i.x,i.y,10,0,2*Math.PI,!0),r.fill(),r.closePath()):i instanceof Fe?(r.beginPath(),r.strokeStyle=s,r.moveTo(i.x1,i.y1),r.lineTo(i.x2,i.y2),r.stroke(),r.closePath()):i instanceof Oe?(r.beginPath(),r.strokeStyle=s,r.drawRect(i.x,i.y,i.width,i.height),r.stroke(),r.closePath()):i instanceof ze&&(r.beginPath(),r.strokeStyle=s,r.arc(i.x,i.y,i.radius,0,2*Math.PI,!0),r.stroke(),r.closePath())})},drawEmitter:function(t,e,i,n){var r=e.getContext("2d"),s=this.getStyle();this.addEventListener(t,function(){n&&r.clearRect(0,0,e.width,e.height),r.beginPath(),r.fillStyle=s,r.arc(i.p.x,i.p.y,10,0,2*Math.PI,!0),r.fill(),r.closePath()})}};function Ne(t,e,i,n){var r;return(r=ye.call(this)||this).reset(t,e,i,n),r}function He(t,e,i,n){var r;return(r=me.call(this)||this).x=t,r.y=e,r.width=i,r.height=n,r}function qe(t,e,i){var n;return(n=ve.call(this)||this).x=t,n.y=e,n.radius=i,n.angle=0,n.center={x:t,y:e},n}function Ge(t,e,i,n,r){var s=be.call(this)||this;return 0<=i-t?(s.x1=t,s.y1=e,s.x2=i,s.y2=n):(s.x1=i,s.y1=n,s.x2=t,s.y2=e),s.dx=s.x2-s.x1,s.dy=s.y2-s.y1,s.minx=Math.min(s.x1,s.x2),s.miny=Math.min(s.y1,s.y2),s.maxx=Math.max(s.x1,s.x2),s.maxy=Math.max(s.y1,s.y2),s.dot=s.x2*s.y1-s.x1*s.y2,s.xxyy=s.dx*s.dx+s.dy*s.dy,s.gradient=s.getGradient(),s.length=s.getLength(),s.direction=a.initValue(r,">"),s}function Xe(t){return(t=xe.call(this,t)||this).name="CustomRenderer",t}function Ye(t){return(t=Ee.call(this,t)||this).gl=t.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),t.gl||alert("Sorry your browser do not suppest WebGL!"),t.initVar(),t.setMaxRadius(),t.initShaders(),t.initBuffers(),t.gl.blendEquation(t.gl.FUNC_ADD),t.gl.blendFunc(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA),t.gl.enable(t.gl.BLEND),t.addImg2Body=t.addImg2Body.bind(d(t)),t.name="WebGLRenderer",t}function je(){this.mats=[];for(var t=this.size=0;t<20;t++)this.mats.push(Y.create([0,0,0,0,0,0,0,0,0]))}function We(t,e){var i;return(i=Ae.call(this,t)||this).stroke=e,i.color=!1,i.setColor=!1,i.blendMode=null,i.pool.create=function(t,e){return i.createBody(t,e)},i.setPIXI(window.PIXI),i.name="PixiRenderer",i}function Ze(t,e){return(t=Pe.call(this,t)||this).context=t.element.getContext("2d"),t.imageData=null,t.rectangle=e,t.createImageData(e),t.name="PixelRenderer",t}function Qe(t,e){return(t=Te.call(this,t)||this).stroke=e,t.name="EaselRenderer",t}function Ke(t){var i;return(i=Re.call(this,t)||this).stroke=null,i.transform3d=!1,i.pool.create=function(t,e){return i.createBody(t,e)},i.addImg2Body=i.addImg2Body.bind(d(i)),i.name="DomRenderer",i}function Je(t){return(t=_e.call(this,t)||this).stroke=null,t.context=t.element.getContext("2d"),t.bufferCache={},t.name="CanvasRenderer",t}function $e(t,e){this.pool=new P,this.element=t,this.stroke=e,this.circleConf={isCircle:!0},this.initEventHandler(),this.name="BaseRenderer"}function ti(t,e,i){return(i=we.call(this,i)||this).mouseTarget=a.initValue(t,window),i.ease=a.initValue(e,.7),i._allowEmitting=!1,i.initEventHandler(),i}function ei(t){return(t=Ce.call(this,t)||this).selfBehaviours=[],t}return i.Particle=q,i.Pool=P,i.Util=a,i.ColorUtil=G,i.MathUtil=o,i.Vector2D=i.Vector=s,i.Polar2D=i.Polar=X,i.ArraySpan=W,i.Rectangle=Z,i.Rate=Q,i.ease=H,i.Span=j,i.Mat3=Y,i.getSpan=function(t,e,i){return new j(t,e,i)},i.createArraySpan=W.createArraySpan,i.Initialize=i.Init=K,i.Life=i.L=n,i.Position=i.P=tt,i.Velocity=i.V=et,i.Mass=i.M=it,i.Radius=i.R=nt,i.Body=i.B=rt,i.Behaviour=st,i.Force=i.F=zt,i.Attraction=i.A=Ot,i.RandomDrift=i.RD=kt,i.Gravity=i.G=Nt,i.Collision=Ht,i.CrossZone=qt,i.Alpha=Gt,i.Scale=i.S=Xt,i.Rotate=Yt,i.Color=jt,i.Repulsion=Qt,i.Cyclone=Zt,i.GravityWell=Kt,i.Emitter=r,i.BehaviourEmitter=e,i.FollowEmitter=Ie,i.Zone=J,i.LineZone=Fe,i.CircleZone=ze,i.PointZone=$,i.RectZone=Oe,i.ImageZone=l,i.CanvasRenderer=De,i.DomRenderer=Ve,i.EaselRenderer=Me,i.PixiRenderer=Le,i.PixelRenderer=Be,i.WebGLRenderer=i.WebGlRenderer=h,i.CustomRenderer=Se,i.Debug=ke,a.assign(i,H),i});