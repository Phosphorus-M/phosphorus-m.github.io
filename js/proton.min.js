/*!
* Proton v5.4.5
* https://github.com/drawcall/Proton
*
* Copyright 2013-2022, drawcall
* Licensed under the MIT license
* http://www.opensource.org/licenses/mit-license
*
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Proton=e()}(this,(function(){"use strict";function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,i(t,e)}function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}var n={},r=function(t,e,i){t.drawImage(e,i.x,i.y);var n=t.getImageData(i.x,i.y,i.width,i.height);return t.clearRect(i.x,i.y,i.width,i.height),n},s=function(t,e,i){var r="string"==typeof t?t:t.src;if(n[r])e(n[r],i);else{var s=new Image;s.onload=function(t){n[r]=t.target,e(n[r],i)},s.src=r}},a={initValue:function(t,e){return t=null!=t?t:e},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyArray:function(t){t&&(t.length=0)},toArray:function(t){return this.isArray(t)?t:[t]},sliceArray:function(t,e,i){this.emptyArray(i);for(var n=e;n<t.length;n++)i.push(t[n])},getRandFromArray:function(t){return t?t[Math.floor(t.length*Math.random())]:null},emptyObject:function(t,e){for(var i in void 0===e&&(e=null),t)e&&e.indexOf(i)>-1||delete t[i]},classApply:function(t,e){return void 0===e&&(e=null),e?new(t.bind.apply(t,[null].concat(e))):new t},getImageData:function(t,e,i){return r(t,e,i)},destroyAll:function(t,e){void 0===e&&(e=null);for(var i=t.length;i--;){try{t[i].destroy(e)}catch(t){}delete t[i]}t.length=0},assign:function(t,e){if("function"!=typeof Object.assign){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}return Object.assign(t,e)}},o={},h={_index:0,_cache:{},id:function(t){return void 0!==o[t]&&null!==o[t]||(o[t]=0),t+"_"+o[t]++},getId:function(t){var e=this.getIdFromCache(t);return e||(e="PUID_"+this._index++,this._cache[e]=t,e)},getIdFromCache:function(t){var e,i;for(i in this._cache){if((e=this._cache[i])===t)return i;if(this.isBody(e,t)&&e.src===t.src)return i}return null},isBody:function(t,e){return"object"==typeof t&&"object"==typeof e&&t.isInner&&e.isInner},getTarget:function(t){return this._cache[t]}},u=function(){function t(t){this.total=0,this.cache={}}var e=t.prototype;return e.get=function(t,e,i){var n;return i=i||t.__puid||h.getId(t),(n=this.cache[i]&&this.cache[i].length>0?this.cache[i].pop():this.createOrClone(t,e)).__puid=t.__puid||i,n},e.expire=function(t){return this.getCache(t.__puid).push(t)},e.createOrClone=function(t,e){return this.total++,this.create?this.create(t,e):"function"==typeof t?a.classApply(t,e):t.clone()},e.getCount=function(){var t=0;for(var e in this.cache)t+=this.cache[e].length;return t++},e.destroy=function(){for(var t in this.cache)this.cache[t].length=0,delete this.cache[t]},e.getCache=function(t){return void 0===t&&(t="default"),this.cache[t]||(this.cache[t]=[]),this.cache[t]},t}(),c=function(){function t(t){this.proton=t,this.container=null,this.type=1,this.emitterIndex=0,this.rendererIndex=0}var e=t.prototype;return e.update=function(t,e){this.add(t,e);var i=this.getEmitter(),n=this.getRenderer(),r="";switch(this.type){case 2:r+="emitter:"+this.proton.emitters.length+"<br>",i&&(r+="em speed:"+i.emitSpeed+"<br>"),i&&(r+="pos:"+this.getEmitterPos(i));break;case 3:i&&(r+="initializes:"+i.initializes.length+"<br>"),i&&(r+='<span style="display:inline-block;">'+this.concatArr(i.initializes)+"</span><br>"),i&&(r+="behaviours:"+i.behaviours.length+"<br>"),i&&(r+='<span style="display:inline-block;">'+this.concatArr(i.behaviours)+"</span><br>");break;case 4:n&&(r+=n.name+"<br>"),n&&(r+="body:"+this.getCreatedNumber(n)+"<br>");break;default:r+="particles:"+this.proton.getCount()+"<br>",r+="pool:"+this.proton.pool.getCount()+"<br>",r+="total:"+this.proton.pool.total}this.container.innerHTML=r},e.add=function(t,e){var i=this;if(!this.container){var n,r;switch(this.type=1,this.container=document.createElement("div"),this.container.style.cssText=["position:absolute;bottom:0px;left:0;cursor:pointer;","opacity:0.9;z-index:10000;padding:10px;font-size:12px;font-family:Helvetica,Arial,sans-serif;","width:120px;height:50px;background-color:#002;color:#0ff;"].join(""),this.container.addEventListener("click",(function(t){i.type++,i.type>4&&(i.type=1)}),!1),t){case 2:n="#201",r="#f08";break;case 3:n="#020",r="#0f0";break;default:n="#002",r="#0ff"}this.container.style["background-color"]=n,this.container.style.color=r}this.container.parentNode||(e=e||this.body||document.body).appendChild(this.container)},e.getEmitter=function(){return this.proton.emitters[this.emitterIndex]},e.getRenderer=function(){return this.proton.renderers[this.rendererIndex]},e.concatArr=function(t){var e="";if(!t||!t.length)return e;for(var i=0;i<t.length;i++)e+=(t[i].name||"").substr(0,1)+".";return e},e.getCreatedNumber=function(t){return t.pool.total||t.cpool&&t.cpool.total||0},e.getEmitterPos=function(t){return Math.round(t.p.x)+","+Math.round(t.p.y)},e.destroy=function(){this.container&&this.container.parentNode&&(this.body||document.body).removeChild(this.container);this.proton=null,this.container=null},t}(),l=function(){function t(){this._listeners=null}t.bind=function(e){e.prototype.dispatchEvent=t.prototype.dispatchEvent,e.prototype.hasEventListener=t.prototype.hasEventListener,e.prototype.addEventListener=t.prototype.addEventListener,e.prototype.removeEventListener=t.prototype.removeEventListener,e.prototype.removeAllEventListeners=t.prototype.removeAllEventListeners};var e=t.prototype;return e.addEventListener=function(t,e){return this._listeners?this.removeEventListener(t,e):this._listeners={},this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),e},e.removeEventListener=function(t,e){if(this._listeners&&this._listeners[t])for(var i=this._listeners[t],n=i.length,r=0;r<n;r++)if(i[r]===e){1===n?delete this._listeners[t]:i.splice(r,1);break}},e.removeAllEventListeners=function(t){t?this._listeners&&delete this._listeners[t]:this._listeners=null},e.dispatchEvent=function(t,e){var i=!1,n=this._listeners;if(t&&n){var r,s=n[t];if(!s)return i;for(var a=s.length;a--;)r=s[a],i=i||r(e)}return!!i},e.hasEventListener=function(t){var e=this._listeners;return!(!e||!e[t])},t}(),d=3.1415926,p={PI:d,PIx2:2*d,PI_2:d/2,PI_180:d/180,N180_PI:180/d,Infinity:-999,isInfinity:function(t){return t===this.Infinity||Infinity===t},randomAToB:function(t,e,i){return void 0===i&&(i=!1),i?(Math.random()*(e-t)>>0)+t:t+Math.random()*(e-t)},randomFloating:function(t,e,i){return this.randomAToB(t-e,t+e,i)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},randomZone:function(t){},floor:function(t,e){void 0===e&&(e=4);var i=Math.pow(10,e);return Math.floor(t*i)/i},degreeTransform:function(t){return t*d/180},toColor16:function(t){return"#"+t.toString(16)}},f=function(){function t(t){this.type=t}var e=t.prototype;return e.calculate=function(t,e,i){this.eulerIntegrate(t,e,i)},e.eulerIntegrate=function(t,e,i){t.sleep||(t.old.p.copy(t.p),t.old.v.copy(t.v),t.a.multiplyScalar(1/t.mass),t.v.add(t.a.multiplyScalar(e)),t.p.add(t.old.v.multiplyScalar(e)),i&&t.v.multiplyScalar(i),t.a.clear())},t}(),y=function(){function e(t){this.emitters=[],this.renderers=[],this.time=0,this.now=0,this.then=0,this.elapsed=0,this.stats=new c(this),this.pool=new u(80),this.integrationType=a.initValue(t,e.EULER),this.integrator=new f(this.integrationType),this._fps="auto",this._interval=e.DEFAULT_INTERVAL}var i,n,r,s=e.prototype;return s.addRenderer=function(t){t.init(this),this.renderers.push(t)},s.removeRenderer=function(t){var e=this.renderers.indexOf(t);this.renderers.splice(e,1),t.remove(this)},s.addEmitter=function(t){this.emitters.push(t),t.parent=this,this.dispatchEvent(e.EMITTER_ADDED,t)},s.removeEmitter=function(t){var i=this.emitters.indexOf(t);this.emitters.splice(i,1),t.parent=null,this.dispatchEvent(e.EMITTER_REMOVED,t)},s.update=function(){"auto"===this._fps?(this.dispatchEvent(e.PROTON_UPDATE),e.USE_CLOCK?(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.amendChangeTabsBug(),this.elapsed>0&&this.emittersUpdate(this.elapsed),this.then=this.now):this.emittersUpdate(e.DEFAULT_INTERVAL),this.dispatchEvent(e.PROTON_UPDATE_AFTER)):(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.elapsed>this._interval&&(this.dispatchEvent(e.PROTON_UPDATE),this.emittersUpdate(this._interval),this.then=this.now-this.elapsed%this._interval*1e3,this.dispatchEvent(e.PROTON_UPDATE_AFTER)))},s.emittersUpdate=function(t){for(var e=this.emitters.length;e--;)this.emitters[e].update(t)},s.amendChangeTabsBug=function(){e.amendChangeTabsBug&&this.elapsed>.5&&(this.then=(new Date).getTime(),this.elapsed=0)},s.getCount=function(){for(var t=0,e=this.emitters.length;e--;)t+=this.emitters[e].particles.length;return t},s.getAllParticles=function(){for(var t=[],e=this.emitters.length;e--;)t=t.concat(this.emitters[e].particles);return t},s.destroyAllEmitters=function(){a.destroyAll(this.emitters)},s.destroy=function(t){var e=this;void 0===t&&(t=!1);var i=function(){e.time=0,e.then=0,e.pool.destroy(),e.stats.destroy(),a.destroyAll(e.emitters),a.destroyAll(e.renderers,e.getAllParticles()),e.integrator=null,e.renderers=null,e.emitters=null,e.stats=null,e.pool=null};t?setTimeout(i,200):i()},i=e,(n=[{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t,this._interval="auto"===t?e.DEFAULT_INTERVAL:p.floor(1/t,7)}}])&&t(i.prototype,n),r&&t(i,r),e}();y.USE_CLOCK=!1,y.MEASURE=100,y.EULER="euler",y.RK2="runge-kutta2",y.PARTICLE_CREATED="PARTICLE_CREATED",y.PARTICLE_UPDATE="PARTICLE_UPDATE",y.PARTICLE_SLEEP="PARTICLE_SLEEP",y.PARTICLE_DEAD="PARTICLE_DEAD",y.EMITTER_ADDED="EMITTER_ADDED",y.EMITTER_REMOVED="EMITTER_REMOVED",y.PROTON_UPDATE="PROTON_UPDATE",y.PROTON_UPDATE_AFTER="PROTON_UPDATE_AFTER",y.DEFAULT_INTERVAL=.0167,y.amendChangeTabsBug=!0,l.bind(y);var v=function(){function t(t,e,i){void 0===t&&(t=255),void 0===e&&(e=255),void 0===i&&(i=255),this.r=t,this.g=e,this.b=i}return t.prototype.reset=function(){this.r=255,this.g=255,this.b=255},t}(),g={hasProp:function(t,e){return!!t&&void 0!==t[e]},setProp:function(t,e){for(var i in e)t.hasOwnProperty(i)&&(t[i]=Span.getSpanValue(e[i]));return t},setVectorVal:function(t,e){void 0===e&&(e=null),e&&(this.hasProp(e,"x")&&(t.p.x=e.x),this.hasProp(e,"y")&&(t.p.y=e.y),this.hasProp(e,"vx")&&(t.v.x=e.vx),this.hasProp(e,"vy")&&(t.v.y=e.vy),this.hasProp(e,"ax")&&(t.a.x=e.ax),this.hasProp(e,"ay")&&(t.a.y=e.ay),this.hasProp(e,"p")&&t.p.copy(e.p),this.hasProp(e,"v")&&t.v.copy(e.v),this.hasProp(e,"a")&&t.a.copy(e.a),this.hasProp(e,"position")&&t.p.copy(e.position),this.hasProp(e,"velocity")&&t.v.copy(e.velocity),this.hasProp(e,"accelerate")&&t.a.copy(e.accelerate))}},m={easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return 1-Math.cos(t*p.PI_2)},easeOutSine:function(t){return Math.sin(t*p.PI_2)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},getEasing:function(t){return"function"==typeof t?t:this[t]||this.easeLinear}},x=function(){function t(t,e){this.x=t||0,this.y=e||0}var e=t.prototype;return e.set=function(t,e){return this.x=t,this.y=e,this},e.setX=function(t){return this.x=t,this},e.setY=function(t){return this.y=t,this},e.getGradient=function(){return 0!==this.x?Math.atan2(this.y,this.x):this.y>0?p.PI_2:this.y<0?-p.PI_2:void 0},e.copy=function(t){return this.x=t.x,this.y=t.y,this},e.add=function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},e.addXY=function(t,e){return this.x+=t,this.y+=e,this},e.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},e.sub=function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},e.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},e.divideScalar=function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},e.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.negate=function(){return this.multiplyScalar(-1)},e.dot=function(t){return this.x*t.x+this.y*t.y},e.lengthSq=function(){return this.x*this.x+this.y*this.y},e.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.normalize=function(){return this.divideScalar(this.length())},e.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},e.rotate=function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)+i*Math.sin(t),this.y=-e*Math.sin(t)+i*Math.cos(t),this},e.distanceToSquared=function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},e.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},e.equals=function(t){return t.x===this.x&&t.y===this.y},e.clear=function(){return this.x=0,this.y=0,this},e.clone=function(){return new t(this.x,this.y)},t}(),E=function(){function t(t){this.id="",this.old=null,this.data=null,this.behaviours=null,this.p=null,this.v=null,this.a=null,this.rgb=null,this.name="Particle",this.id=h.id(this.name),this.old={},this.data={},this.behaviours=[],this.p=new x,this.v=new x,this.a=new x,this.old.p=new x,this.old.v=new x,this.old.a=new x,this.rgb=new v,this.reset(),t&&g.setProp(this,t)}var e=t.prototype;return e.getDirection=function(){return Math.atan2(this.v.x,-this.v.y)*p.N180_PI},e.reset=function(){return this.life=1/0,this.age=0,this.dead=!1,this.sleep=!1,this.body=null,this.sprite=null,this.parent=null,this.energy=1,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.easing=m.easeLinear,this.rgb.reset(),a.emptyObject(this.data),this.removeAllBehaviours(),this},e.update=function(t,e){if(this.sleep||(this.age+=t,this.applyBehaviours(t,e)),this.age<this.life){var i=this.easing(this.age/this.life);this.energy=Math.max(1-i,0)}else this.destroy()},e.applyBehaviours=function(t,e){var i,n=this.behaviours.length;for(i=0;i<n;i++)this.behaviours[i]&&this.behaviours[i].applyBehaviour(this,t,e)},e.addBehaviour=function(t){this.behaviours.push(t),t.hasOwnProperty("parents")&&t.parents.push(this),t.initialize(this)},e.addBehaviours=function(t){var e,i=t.length;for(e=0;e<i;e++)this.addBehaviour(t[e])},e.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);e>-1&&(this.behaviours.splice(e,1).parents=null)},e.removeAllBehaviours=function(){a.emptyArray(this.behaviours)},e.destroy=function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null},t}(),b=function(){function t(t,e,i){a.isArray(t)?(this.isArray=!0,this.a=t):(this.isArray=!1,this.a=a.initValue(t,1),this.b=a.initValue(e,this.a),this.center=a.initValue(i,!1))}return t.prototype.getValue=function(t){return void 0===t&&(t=!1),this.isArray?a.getRandFromArray(this.a):this.center?p.randomFloating(this.a,this.b,t):p.randomAToB(this.a,this.b,t)},t.setSpanValue=function(e,i,n){return e instanceof t?e:void 0===i?new t(e):void 0===n?new t(e,i):new t(e,i,n)},t.getSpanValue=function(e){return e instanceof t?e.getValue():e},t}(),P=function(){function t(t,e){this.numPan=b.setSpanValue(a.initValue(t,1)),this.timePan=b.setSpanValue(a.initValue(e,1)),this.startTime=0,this.nextTime=0,this.init()}var e=t.prototype;return e.init=function(){this.startTime=0,this.nextTime=this.timePan.getValue()},e.getValue=function(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),1===this.numPan.b?this.numPan.getValue(!1)>.5?1:0:this.numPan.getValue(!0)):0},t}(),T=function(){function t(){}var e=t.prototype;return e.reset=function(){},e.init=function(t,e){e?this.initialize(e):this.initialize(t)},e.initialize=function(t){},t}(),A=function(t){function i(e,i,n){var r;return(r=t.call(this)||this).lifePan=b.setSpanValue(e,i,n),r.name="Life",r}return e(i,t),i.prototype.initialize=function(t){this.lifePan.a===1/0?t.life=1/0:t.life=this.lifePan.getValue()},i}(T),_=function(){function t(){this.vector=new x(0,0),this.random=0,this.crossType="dead",this.alert=!0}var e=t.prototype;return e.getPosition=function(){},e.crossing=function(t){},e.destroy=function(){this.vector=null},t}(),I=function(t){function i(e,i){var n;return(n=t.call(this)||this).x=e,n.y=i,n}e(i,t);var n=i.prototype;return n.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector},n.crossing=function(t){this.alert&&(console.error("Sorry, PointZone does not support crossing method!"),this.alert=!1)},i}(_),w=function(t){function i(e){var i;return(i=t.call(this)||this).zone=a.initValue(e,new I),i.name="Position",i}e(i,t);var n=i.prototype;return n.reset=function(t){this.zone=a.initValue(t,new I)},n.initialize=function(t){this.zone.getPosition(),t.p.x=this.zone.vector.x,t.p.y=this.zone.vector.y},i}(T),M=function(){function t(t,e){this.r=Math.abs(t)||0,this.tha=e||0}var e=t.prototype;return e.set=function(t,e){return this.r=t,this.tha=e,this},e.setR=function(t){return this.r=t,this},e.setTha=function(t){return this.tha=t,this},e.copy=function(t){return this.r=t.r,this.tha=t.tha,this},e.toVector=function(){return new x(this.getX(),this.getY())},e.getX=function(){return this.r*Math.sin(this.tha)},e.getY=function(){return-this.r*Math.cos(this.tha)},e.normalize=function(){return this.r=1,this},e.equals=function(t){return t.r===this.r&&t.tha===this.tha},e.clear=function(){return this.r=0,this.tha=0,this},e.clone=function(){return new t(this.r,this.tha)},t}(),R=function(t){function i(e,i,n){var r;return(r=t.call(this)||this).rPan=b.setSpanValue(e),r.thaPan=b.setSpanValue(i),r.type=a.initValue(n,"vector"),r.name="Velocity",r}e(i,t);var n=i.prototype;return n.reset=function(t,e,i){this.rPan=b.setSpanValue(t),this.thaPan=b.setSpanValue(e),this.type=a.initValue(i,"vector")},n.normalizeVelocity=function(t){return t*y.MEASURE},n.initialize=function(t){if("p"===this.type||"P"===this.type||"polar"===this.type){var e=new M(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*p.PI_180);t.v.x=e.getX(),t.v.y=e.getY()}else t.v.x=this.normalizeVelocity(this.rPan.getValue()),t.v.y=this.normalizeVelocity(this.thaPan.getValue())},i}(T),V=function(t){function i(e,i,n){var r;return(r=t.call(this)||this).massPan=b.setSpanValue(e,i,n),r.name="Mass",r}return e(i,t),i.prototype.initialize=function(t){t.mass=this.massPan.getValue()},i}(T),C=function(t){function i(e,i,n){var r;return(r=t.call(this)||this).radius=b.setSpanValue(e,i,n),r.name="Radius",r}e(i,t);var n=i.prototype;return n.reset=function(t,e,i){this.radius=b.setSpanValue(t,e,i)},n.initialize=function(t){t.radius=this.radius.getValue(),t.data.oldRadius=t.radius},i}(T),D=function(t){function i(e){var i;return(i=t.call(this)||this)._arr=a.toArray(e),i}return e(i,t),i.prototype.getValue=function(){var t=a.getRandFromArray(this._arr);return"random"===t||"Random"===t?p.randomColor():t},i.createArraySpan=function(t){return t?t instanceof i?t:new i(t):null},i}(b),O=function(t){function i(e,i,n){var r;return(r=t.call(this)||this).image=r.setSpanValue(e),r.w=a.initValue(i,20),r.h=a.initValue(n,r.w),r.name="Body",r}e(i,t);var n=i.prototype;return n.initialize=function(t){var e=this.image.getValue();t.body="string"==typeof e?{width:this.w,height:this.h,src:e,isInner:!0,inner:!0}:e},n.setSpanValue=function(t){return t instanceof D?t:new D(t)},i}(T),S=function(){function t(e,i){this.life=a.initValue(e,1/0),this.easing=m.getEasing(i),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.id="Behaviour_"+t.id++,this.name="Behaviour"}var e=t.prototype;return e.reset=function(t,e){this.life=a.initValue(t,1/0),this.easing=m.getEasing(e)},e.normalizeForce=function(t){return t.multiplyScalar(y.MEASURE)},e.normalizeValue=function(t){return t*y.MEASURE},e.initialize=function(t){},e.calculate=function(t,e,i){if(this.age+=e,this.age>=this.life||this.dead)this.energy=0,this.dead=!0,this.destroy();else{var n=this.easing(t.age/t.life);this.energy=Math.max(1-n,0)}},e.applyBehaviour=function(t,e,i){this.calculate(t,e,i)},e.destroy=function(){for(var t=this.parents.length;t--;)this.parents[t].removeBehaviour(this);this.parents.length=0},t}();S.id=0;var L=function(t){function i(e,i,n,r){var s;return(s=t.call(this,n,r)||this).reset(e,i),s.name="CrossZone",s}e(i,t);var n=i.prototype;return n.reset=function(e,i,n,r){this.zone=e,this.zone.crossType=a.initValue(i,"dead"),n&&t.prototype.reset.call(this,n,r)},n.applyBehaviour=function(t,e,i){this.calculate(t,e,i),this.zone.crossing(t)},i}(S),U=function(t){function i(e,i,n,r){var s;return(s=t.call(this,n,r)||this).reset(e,i),s.name="Alpha",s}e(i,t);var n=i.prototype;return n.reset=function(e,i,n,r){this.same=null==i,this.a=b.setSpanValue(a.initValue(e,1)),this.b=b.setSpanValue(i),n&&t.prototype.reset.call(this,n,r)},n.initialize=function(t){t.data.alphaA=this.a.getValue(),this.same?t.data.alphaB=t.data.alphaA:t.data.alphaB=this.b.getValue()},n.applyBehaviour=function(t,e,i){this.calculate(t,e,i),t.alpha=t.data.alphaB+(t.data.alphaA-t.data.alphaB)*this.energy,t.alpha<.001&&(t.alpha=0)},i}(S),B=function(t){var e="#"===t.charAt(0)?t.substring(1,7):t;return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16)}},z=function(t){return"rgb("+t.r+", "+t.g+", "+t.b+")"},k=function(t){function i(e,i,n,r){var s;return(s=t.call(this,n,r)||this).reset(e,i),s.name="Color",s}e(i,t);var n=i.prototype;return n.reset=function(e,i,n,r){this.a=D.createArraySpan(e),this.b=D.createArraySpan(i),n&&t.prototype.reset.call(this,n,r)},n.initialize=function(t){t.color=this.a.getValue(),t.data.colorA=B(t.color),this.b&&(t.data.colorB=B(this.b.getValue()))},n.applyBehaviour=function(t,e,i){this.b?(this.calculate(t,e,i),t.rgb.r=t.data.colorB.r+(t.data.colorA.r-t.data.colorB.r)*this.energy,t.rgb.g=t.data.colorB.g+(t.data.colorA.g-t.data.colorB.g)*this.energy,t.rgb.b=t.data.colorB.b+(t.data.colorA.b-t.data.colorB.b)*this.energy,t.rgb.r=t.rgb.r<<0,t.rgb.g=t.rgb.g<<0,t.rgb.b=t.rgb.b<<0):(t.rgb.r=t.data.colorA.r,t.rgb.g=t.data.colorA.g,t.rgb.b=t.data.colorA.b)},i}(S),N={initialize:function(t,e,i){var n,r=i.length;for(n=0;n<r;n++)i[n]instanceof T?i[n].init(t,e):this.init(t,e,i[n]);this.bindEmitter(t,e)},init:function(t,e,i){g.setProp(e,i),g.setVectorVal(e,i)},bindEmitter:function(t,e){t.bindEmitter&&(e.p.add(t.p),e.v.add(t.v),e.a.add(t.a),e.v.rotate(p.degreeTransform(t.rotation)))}},H=function(t){function i(e){var i;return void 0===e&&(e={}),(i=t.call(this,e)||this).particles=[],i.behaviours=[],i.initializes=[],i.emitTime=0,i.emitSpeed=0,i.totalTime=-1,i.damping=.006,i.bindEmitter=!0,i.rate=new P(1,.1),i.name="Emitter",i.id=h.id(i.name),i}e(i,t);var n=i.prototype;return n.emit=function(t,e){this.stoped=!1,this.emitTime=0,this.totalTime=a.initValue(t,1/0),!0===e||"life"===e||"destroy"===e?this.life="once"===t?1:this.totalTime:isNaN(e)||(this.life=e),this.rate.init()},n.stop=function(){this.totalTime=-1,this.emitTime=0,this.stoped=!0},n.preEmit=function(t){var e=this.stoped,i=this.emitTime,n=this.totalTime;this.stoped=!1,this.emitTime=0,this.totalTime=t,this.rate.init();for(var r=.0167;t>r;)t-=r,this.update(r);this.stoped=e,this.emitTime=i+Math.max(t,0),this.totalTime=n},n.removeAllParticles=function(){for(var t=this.particles.length;t--;)this.particles[t].dead=!0},n.addSelfInitialize=function(t){t.init&&t.init(this)},n.addInitialize=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=e.length;n--;)this.initializes.push(e[n])},n.removeInitialize=function(t){var e=this.initializes.indexOf(t);e>-1&&this.initializes.splice(e,1)},n.removeAllInitializers=function(){a.emptyArray(this.initializes)},n.addBehaviour=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=arguments.length;n--;){var r=e[n];this.behaviours.push(r),r.parents&&r.parents.push(this)}},n.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);return this.behaviours.splice(e,1),t.parents&&(e=t.parents.indexOf(t),t.parents.splice(e,1)),e},n.removeAllBehaviours=function(){a.emptyArray(this.behaviours)},n.update=function(t){this.age+=t,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(t),this.integrate(t)},n.integrate=function(t){if(this.parent){var e,i,n=1-this.damping;for(this.parent.integrator.calculate(this,t,n),e=this.particles.length-1;e>=0;e--)(i=this.particles[e]).update(t,e),this.parent.integrator.calculate(i,t,n),this.dispatch("PARTICLE_UPDATE",i),i.dead&&(this.dispatch("PARTICLE_DEAD",i),this.parent.pool.expire(i),this.particles.splice(e,1))}},n.dispatch=function(t,e){this.parent&&this.parent.dispatchEvent(t,e),this.bindEvent&&this.dispatchEvent(t,e)},n.emitting=function(t){if("once"===this.totalTime){var e,i=this.rate.getValue(99999);for(i>0&&(this.emitSpeed=i),e=0;e<i;e++)this.createParticle();this.totalTime="none"}else if(this.emitTime+=t,this.emitTime<this.totalTime){var n,r=this.rate.getValue(t);for(r>0&&(this.emitSpeed=r),n=0;n<r;n++)this.createParticle()}},n.createParticle=function(t,e){var i=this.parent.pool.get(E);return this.setupParticle(i,t,e),this.dispatch("PARTICLE_CREATED",i),i},n.setupParticle=function(t,e,i){var n=this.initializes,r=this.behaviours;e&&(n=a.toArray(e)),i&&(r=a.toArray(i)),t.reset(),N.initialize(this,t,n),t.addBehaviours(r),t.parent=this,this.particles.push(t)},n.remove=function(){this.stop(),a.destroyAll(this.particles)},n.destroy=function(){this.dead=!0,this.remove(),this.removeAllInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this),this.rate=null,this.old=null,this.rgb=null,this.v=null,this.a=null,this.p=null},i}(E);l.bind(H);var F=function(t){if(!t)return!1;if(t.__isImage)return!0;var e=(""+t.tagName).toUpperCase();return("IMG"===(""+t.nodeName).toUpperCase()||"IMG"===e)&&(t.__isImage=!0,!0)},j=function(t){function i(e){var i;return(i=t.call(this,e)||this).stroke=null,i.context=i.element.getContext("2d"),i.bufferCache={},i.name="CanvasRenderer",i}e(i,t);var n=i.prototype;return n.resize=function(t,e){this.element.width=t,this.element.height=e},n.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},n.onParticleCreated=function(t){t.body?s(t.body,this.addImg2Body,t):t.color=t.color||"#ff0000"},n.onParticleUpdate=function(t){t.body?F(t.body)&&this.drawImage(t):this.drawCircle(t)},n.onParticleDead=function(t){t.body=null},n.addImg2Body=function(t,e){e.body=t},n.drawImage=function(t){var e=t.body.width*t.scale|0,i=t.body.height*t.scale|0,n=t.p.x-e/2,r=t.p.y-i/2;if(t.color){t.data.buffer||(t.data.buffer=this.createBuffer(t.body));var s=t.data.buffer.getContext("2d");s.clearRect(0,0,t.data.buffer.width,t.data.buffer.height),s.globalAlpha=t.alpha,s.drawImage(t.body,0,0),s.globalCompositeOperation="source-atop",s.fillStyle=z(t.rgb),s.fillRect(0,0,t.data.buffer.width,t.data.buffer.height),s.globalCompositeOperation="source-over",s.globalAlpha=1,this.context.drawImage(t.data.buffer,0,0,t.data.buffer.width,t.data.buffer.height,n,r,e,i)}else this.context.save(),this.context.globalAlpha=t.alpha,this.context.translate(t.p.x,t.p.y),this.context.rotate(p.degreeTransform(t.rotation)),this.context.translate(-t.p.x,-t.p.y),this.context.drawImage(t.body,0,0,t.body.width,t.body.height,n,r,e,i),this.context.globalAlpha=1,this.context.restore()},n.drawCircle=function(t){t.rgb?this.context.fillStyle="rgba("+t.rgb.r+","+t.rgb.g+","+t.rgb.b+","+t.alpha+")":this.context.fillStyle=t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},n.createBuffer=function(t){if(F(t)){var e=t.width+"_"+t.height,i=this.bufferCache[e];return i||((i=document.createElement("canvas")).width=t.width,i.height=t.height,this.bufferCache[e]=i),i}},n.destroy=function(){t.prototype.destroy.call(this),this.stroke=null,this.context=null,this.bufferCache=null},i}(function(){function t(t,e){this.pool=new u,this.element=t,this.stroke=e,this.circleConf={isCircle:!0},this.initEventHandler(),this.name="BaseRenderer"}var e=t.prototype;return e.setStroke=function(t,e){void 0===t&&(t="#000000"),void 0===e&&(e=1),this.stroke={color:t,thinkness:e}},e.initEventHandler=function(){var t=this;this._protonUpdateHandler=function(){t.onProtonUpdate.call(t)},this._protonUpdateAfterHandler=function(){t.onProtonUpdateAfter.call(t)},this._emitterAddedHandler=function(e){t.onEmitterAdded.call(t,e)},this._emitterRemovedHandler=function(e){t.onEmitterRemoved.call(t,e)},this._particleCreatedHandler=function(e){t.onParticleCreated.call(t,e)},this._particleUpdateHandler=function(e){t.onParticleUpdate.call(t,e)},this._particleDeadHandler=function(e){t.onParticleDead.call(t,e)}},e.init=function(t){this.parent=t,t.addEventListener("PROTON_UPDATE",this._protonUpdateHandler),t.addEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),t.addEventListener("EMITTER_ADDED",this._emitterAddedHandler),t.addEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),t.addEventListener("PARTICLE_CREATED",this._particleCreatedHandler),t.addEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),t.addEventListener("PARTICLE_DEAD",this._particleDeadHandler)},e.resize=function(t,e){},e.destroy=function(){this.remove(),this.pool.destroy(),this.pool=null,this.element=null,this.stroke=null},e.remove=function(t){this.parent.removeEventListener("PROTON_UPDATE",this._protonUpdateHandler),this.parent.removeEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),this.parent.removeEventListener("EMITTER_ADDED",this._emitterAddedHandler),this.parent.removeEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),this.parent.removeEventListener("PARTICLE_CREATED",this._particleCreatedHandler),this.parent.removeEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),this.parent.removeEventListener("PARTICLE_DEAD",this._particleDeadHandler),this.parent=null},e.onProtonUpdate=function(){},e.onProtonUpdateAfter=function(){},e.onEmitterAdded=function(t){},e.onEmitterRemoved=function(t){},e.onParticleCreated=function(t){},e.onParticleUpdate=function(t){},e.onParticleDead=function(t){},t}()),q=function(t){function i(e,i,n,r){var s;return(s=t.call(this)||this).x=e,s.y=i,s.width=n,s.height=r,s}e(i,t);var n=i.prototype;return n.getPosition=function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector},n.crossing=function(t){"dead"===this.crossType?((t.p.x+t.radius<this.x||t.p.x-t.radius>this.x+this.width)&&(t.dead=!0),(t.p.y+t.radius<this.y||t.p.y-t.radius>this.y+this.height)&&(t.dead=!0)):"bound"===this.crossType?(t.p.x-t.radius<this.x?(t.p.x=this.x+t.radius,t.v.x*=-1):t.p.x+t.radius>this.x+this.width&&(t.p.x=this.x+this.width-t.radius,t.v.x*=-1),t.p.y-t.radius<this.y?(t.p.y=this.y+t.radius,t.v.y*=-1):t.p.y+t.radius>this.y+this.height&&(t.p.y=this.y+this.height-t.radius,t.v.y*=-1)):"cross"===this.crossType&&(t.p.x+t.radius<this.x&&t.v.x<=0?t.p.x=this.x+this.width+t.radius:t.p.x-t.radius>this.x+this.width&&t.v.x>=0&&(t.p.x=this.x-t.radius),t.p.y+t.radius<this.y&&t.v.y<=0?t.p.y=this.y+this.height+t.radius:t.p.y-t.radius>this.y+this.height&&t.v.y>=0&&(t.p.y=this.y-t.radius))},i}(_),G=function(t){function i(e,i,n){var r;return(r=t.call(this)||this).x=e,r.y=i,r.radius=n,r.angle=0,r.center={x:e,y:i},r}e(i,t);var n=i.prototype;return n.getPosition=function(){return this.angle=p.PIx2*Math.random(),this.randomRadius=Math.random()*this.radius,this.vector.x=this.x+this.randomRadius*Math.cos(this.angle),this.vector.y=this.y+this.randomRadius*Math.sin(this.angle),this.vector},n.setCenter=function(t,e){this.center.x=t,this.center.y=e},n.crossing=function(t){var e=t.p.distanceTo(this.center);"dead"===this.crossType?e-t.radius>this.radius&&(t.dead=!0):"bound"===this.crossType?e+t.radius>=this.radius&&this.getSymmetric(t):"cross"===this.crossType&&this.alert&&(console.error("Sorry, CircleZone does not support cross method!"),this.alert=!1)},n.getSymmetric=function(t){var e=t.v.getGradient(),i=2*(this.getGradient(t)-e),n=t.v.x,r=t.v.y;t.v.x=n*Math.cos(i)-r*Math.sin(i),t.v.y=n*Math.sin(i)+r*Math.cos(i)},n.getGradient=function(t){return-p.PI_2+Math.atan2(t.p.y-this.center.y,t.p.x-this.center.x)},i}(_),Z=function(t){function i(e,i,n,r,s){var o;return o=t.call(this)||this,n-e>=0?(o.x1=e,o.y1=i,o.x2=n,o.y2=r):(o.x1=n,o.y1=r,o.x2=e,o.y2=i),o.dx=o.x2-o.x1,o.dy=o.y2-o.y1,o.minx=Math.min(o.x1,o.x2),o.miny=Math.min(o.y1,o.y2),o.maxx=Math.max(o.x1,o.x2),o.maxy=Math.max(o.y1,o.y2),o.dot=o.x2*o.y1-o.x1*o.y2,o.xxyy=o.dx*o.dx+o.dy*o.dy,o.gradient=o.getGradient(),o.length=o.getLength(),o.direction=a.initValue(s,">"),o}e(i,t);var n=i.prototype;return n.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector},n.getDirection=function(t,e){var i=this.dy,n=-this.dx;return(i*t+n*e+this.dot)*(0===n?1:n)>0},n.getDistance=function(t,e){return(this.dy*t+-this.dx*e+this.dot)/Math.sqrt(this.xxyy)},n.getSymmetric=function(t){var e=t.getGradient(),i=2*(this.getGradient()-e),n=t.x,r=t.y;return t.x=n*Math.cos(i)-r*Math.sin(i),t.y=n*Math.sin(i)+r*Math.cos(i),t},n.getGradient=function(){return Math.atan2(this.dy,this.dx)},n.rangeOut=function(t){if(Math.abs(this.getGradient())<=p.PI/4){if(t.p.x<=this.maxx&&t.p.x>=this.minx)return!0}else if(t.p.y<=this.maxy&&t.p.y>=this.miny)return!0;return!1},n.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},n.crossing=function(t){if("dead"===this.crossType)if(">"===this.direction||"R"===this.direction||"right"===this.direction||"down"===this.direction){if(!this.rangeOut(t))return;this.getDirection(t.p.x,t.p.y)&&(t.dead=!0)}else{if(!this.rangeOut(t))return;this.getDirection(t.p.x,t.p.y)||(t.dead=!0)}else if("bound"===this.crossType){if(!this.rangeOut(t))return;this.getDistance(t.p.x,t.p.y)<=t.radius&&(0===this.dx?t.v.x*=-1:0===this.dy?t.v.y*=-1:this.getSymmetric(t.v))}else"cross"===this.crossType&&this.alert&&(console.error("Sorry, LineZone does not support cross method!"),this.alert=!1)},i}(_),Q={addEventListener:function(t,e){t.addEventListener("PROTON_UPDATE_AFTER",(function(){return e()}))},getStyle:function(t){void 0===t&&(t="#ff0000");var e=B(t);return"rgba("+e.r+", "+e.g+", "+e.b+", 0.5)"},drawZone:function(t,e,i,n){var r=e.getContext("2d"),s=this.getStyle();this.addEventListener(t,(function(){n&&r.clearRect(0,0,e.width,e.height),i instanceof I?(r.beginPath(),r.fillStyle=s,r.arc(i.x,i.y,10,0,2*Math.PI,!0),r.fill(),r.closePath()):i instanceof Z?(r.beginPath(),r.strokeStyle=s,r.moveTo(i.x1,i.y1),r.lineTo(i.x2,i.y2),r.stroke(),r.closePath()):i instanceof q?(r.beginPath(),r.strokeStyle=s,r.drawRect(i.x,i.y,i.width,i.height),r.stroke(),r.closePath()):i instanceof G&&(r.beginPath(),r.strokeStyle=s,r.arc(i.x,i.y,i.radius,0,2*Math.PI,!0),r.stroke(),r.closePath())}))},drawEmitter:function(t,e,i,n){var r=e.getContext("2d"),s=this.getStyle();this.addEventListener(t,(function(){n&&r.clearRect(0,0,e.width,e.height),r.beginPath(),r.fillStyle=s,r.arc(i.p.x,i.p.y,10,0,2*Math.PI,!0),r.fill(),r.closePath()}))}};return y.Particle=E,y.Util=a,y.Rate=P,y.ease=m,y.Span=b,y.getSpan=function(t,e,i){return new b(t,e,i)},y.Initialize=y.Init=T,y.Life=y.L=A,y.Position=y.P=w,y.Velocity=y.V=R,y.Mass=y.M=V,y.Radius=y.R=C,y.Body=y.B=O,y.Behaviour=S,y.CrossZone=L,y.Alpha=U,y.Color=k,y.Emitter=H,y.Zone=_,y.RectZone=q,y.CanvasRenderer=j,y.Debug=Q,a.assign(y,m),y}));
//# sourceMappingURL=proton.min.js.map
